var InfoJet_WebContext="";var InfoJet_NoErrorFormatting=false;var InfoJet_BrowserQuick=false;var InfoJet_Changed=false;var InfoJet_Postbacking=0;var InfoJet_ValidSubmit=true;var InfoJet_LocalResources={};InfoJet_LocalResources.ClickAgainMessage="The button click is interrupted by a postback, please try again.";InfoJet_LocalResources.CorrectFirstMessage="This form contains validation errors. Errors are marked with either a red asterisk(required fields) or a red, dashed border(invalid values). \nPlease correct them first.";InfoJet_LocalResources.TryAgainMessage="Please try again while the postback progress is finished.";InfoJet_LocalResources.CloseAnywayMessage="The document has been changed, do you want to close anyway?";InfoJet_LocalResources.DeleteAllMessage="This action will delete all information in the current form.\n\nDo you want to continue?";var InfoJet_AMP="&";var InfoJet_NoValidation=false;var InfoJet_NoPostback=false;var InfoJet_UseAjax=true;var InfoJet_XHR=null;var InfoJet_AjaxBracket=null;var InfoJet_ShortDatePattern="yyyy-M-d";var InfoJet_LongDatePattern="yyyy-MM-dd";var InfoJet_YearMonthPattern="yyyy-M";var InfoJet_XdPrefix="xd:";var InfoJet_SelectFileMessage="[Please select a file ...]";var InfoJet_EnableUnderline=false;var InfoJet_XDocumentDOM=null;var InfoJet_ReplaceBrowserContextMenu=true;var InfoJet_ShowMenuArrow=true;var InfoJet_Progress=null;var InfoJet_ShowProgress=false;var InfoJet_ItemElement=null;var InfoJet_Canvas=null;var InfoJet_IsCanvasTranparent=true;var InfoJet_FocusHolder=null;var InfoJet_FuncAfterInit=null;var InfoJet_SaveAsPage=null;var InfoJet_EnableReplaceGroupingSymbol=false;var InfoJet_ViewSwitchValidation=false;var InfoJet_SaveAsWindow=null;var InfoJet_Selects=null;var InfoJet_XmlToEditItems=null;var InfoJet_FocusControlId=null;var InfoJet_NewStructureNodeId=null;var InfoJet_OldValueState=null;var InfoJet_HookDocumentOnClickEvent=true;var InfoJet_FocusFirstControlAfterInited=false;var InfoJet_NumberDecimalSeparator=".";var InfoJet_NumberGroupSeparator=",";var InfoJet_CurrencyDecimalSeparator=".";var InfoJet_CurrencyGroupSeparator=",";var InfoJet_ScrollFollowUpFormViewIntoView=false;var InfoJet_CachedPostbackButtonId=null;var InfoJet_Container=null;var InfoJet_OffsetX=0;var InfoJet_OffsetY=0;var InfoJet_CurrentDialog=null;var InfoJet_NonProofingNodeNameArrays=null;var InfoJet_CurrentViewName=null;var InfoJet_HideTryAgainNotification=false;var InfoJet_PSVITable=null;var InfoJet_OnChangeTable=null;var InfoJet_FieldOverTop=null;var InfoJet_FieldOverBottom=null;var InfoJet_FieldOverLeft=null;var InfoJet_FieldOverRight=null;var InfoJet_ItemOverTop=null;var InfoJet_ItemOverBottom=null;var InfoJet_ItemOverLeft=null;var InfoJet_ItemOverRight=null;var InfoJet_FieldFocusTop=null;var InfoJet_FieldFocusBottom=null;var InfoJet_FieldFocusLeft=null;var InfoJet_FieldFocusRight=null;var InfoJet_ItemFocusTop=null;var InfoJet_ItemFocusBottom=null;var InfoJet_ItemFocusLeft=null;var InfoJet_ItemFocusRight=null;var InfoJet_FormatReadonlyView=false;var InfoJet_EnableFormFieldsCache=false;var InfoJet_OnClickTable=null;var InfoJet_FocusItemIndex=-1;var InfoJet_PingXHR=null;var InfoJet_PingInterval=60*1000*5;var InfoJet_PingParameter=null;var InfoJet_IsPinging=false;var InfoJet_RedAsteriskOTA=false;var InfoJet_RtbPanel=null;var InfoJet_NicEditor=null;var InfoJet_EditRichTextOnFocus=false;var InfoJet_NicEditor_PaneExisting=false;var InfoJet_EnablePlaceholderUI=false;function InfoJet_Log(b){var a=document.getElementById("InfoJet_LogTextArea");if(a!=null){a.value+="\r\n"+b}}function InfoJet_ResolveServiceAction(){var e=window.location.pathname.lastIndexOf("/");var b=window.location.pathname.substring(0,e+1);var a=document.getElementById("xdoc_param_action").value;var d=true;if(/^[A-Za-z]:\\/.test(a)){d=false}if(a.indexOf("\\")==0){d=false}if(a.indexOf("/")==0){d=false}if(d){var c=b+a;return c}else{return a}}function InfoJet_IsValid(){var b=document.getElementById("xdoc_data_error");if(b==null){return true}var c=0;for(var a=0;a<b.childNodes.length;a++){if(b.childNodes[a].nodeType==1){c++}}if(c>0){return false}else{return true}return true}function InfoJet_IsViewValid(){var c=document.getElementById("xdoc_fieldstyle");if(c==null){return true}for(var a=0;a<c.childNodes.length;a++){var b=c.childNodes[a];if(b.nodeType==1){if(b.id.lastIndexOf("_notBlank")==(b.id.length-9)){if(b.style.display!="none"){return false}}else{if(parseInt(b.style.height)>0||parseInt(b.style.width)>0){return false}}}}return true}function InfoJet_NeedSectionBorder(d){if(d==null){return}if(d.tagName){var a=d.tagName.toLowerCase();try{var b=d.getAttribute(InfoJet_XdPrefix+"xctname");if(b==null||b.length<=0){if(a=="tr"||a=="td"){return true}else{return false}}else{if(b!=null&&b=="ExpressionBox"){return false}else{return true}}}catch(c){return false}}}function InfoJet_NeedFieldBorder(b){if(InfoJet_IsTextControl(b)){if(!b.disabled){return true}else{return false}}var a=b.tagName.toLowerCase();if(a=="img"){return true}return false}function InfoJet_IsTextControl(b){var a=b.getAttribute("isTextControl");if(a==null){a=InfoJet_CheckTextControl(b);b.setAttribute("isTextControl",a)}if(a=="1"){return true}else{return false}}function InfoJet_CheckTextControl(d){var a=null;try{a=d.tagName.toLowerCase()}catch(c){return"0"}if(a=="input"){var b=d.getAttribute("type");if(b!=null){b=b.toLowerCase();if(b=="text"||b=="password"){return"1"}}}else{if(a=="textarea"){return"1"}}return"0"}function InfoJet_IsSingleLineTextControl(d){if(InfoJet_IsTextControl(d)){var b=null;try{b=d.tagName.toLowerCase()}catch(c){return false}if(b=="input"){return true}if(b=="textarea"){if(InfoJet_IsIdInArray(InfoJet_GetElementId(d),"xdoc_data_nobreak_id_array")){return true}var a=d.getAttribute("default_rows");if(a!=null&&a=="1"){return true}}}return false}function InfoJet_IsSelect(b){var a=b.tagName.toLowerCase();if(a=="select"){return true}return false}function InfoJet_IsIdInArray(f,e){var b=document.getElementById(e);if(b==null){return false}var d=b.innerHTML;var c=d.split(";");for(var a=0;a<c.length;a++){if(f==c[a]){return true}}return false}function InfoJet_GetElementId(a){var b=a.id;return InfoJet_GetPureId(b)}function InfoJet_GetPureId(b){var a=b.indexOf(",");if(a>0){return b.substr(0,a)}else{return b}}function InfoJet_PureIdEquals(b,a){if(InfoJet_GetPureId(b)==InfoJet_GetPureId(a)){return true}else{return false}}function InfoJet_IsIE(){if(document.all){return true}else{return false}}function InfoJet_IsIE7(){if(typeof(document.body.style.maxHeight)!="undefined"){return true}else{return false}}function InfoJet_GetEvent(a){if(a==null){return window.event}else{return a}}function InfoJet_GetParent(a){if(a==null){return null}if(InfoJet_IsIE()){return a.parentElement}else{return a.parentNode}}function InfoJet_GetAllChildren(a){var b=new Array();InfoJet_GetChildren(a,b);return b}function InfoJet_GetChildren(c,d){for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];if(a.nodeType==1){d.push(a);InfoJet_GetChildren(a,d)}}}function InfoJet_GetFrameDocument(a){if(InfoJet_IsIE()){var b=document.frames[a];return b.document}else{var b=document.getElementById(a);return b.contentDocument}}function InfoJet_GetDocumentForm(a,b){if(InfoJet_IsIE()){return a.forms[b]}else{return a.getElementById(b)}}function InfoJet_ShouldContinueBlur(){if(InfoJet_IsIE()){var b=document.activeElement;if(b!=null){if(b.id=="xdoc_menu_focus_arrow"){return false}if(!InfoJet_EditRichTextOnFocus){if(b.id=="xdoc_menu_rtb_edit"){return false}}var a=b.getAttribute("xdoc_menu");if(a!=null&&a=="yes"){return false}}return true}else{var c=document.getElementById("xdoc_menu_focus_arrow");if(c&&c.style.display=="block"){return false}if(!InfoJet_EditRichTextOnFocus){var d=document.getElementById("xdoc_menu_rtb_edit");if(d&&d.style.display=="block"){return false}}return true}}function InfoJet_SimulateFocus(b,c,a){if(!InfoJet_IsIE()){InfoJet_OnFocus(b,c,a)}}function InfoJet_GetPos(f){try{var j={left:0,top:0};if(InfoJet_IsIE()){var k=f.getBoundingClientRect();var h=0;var d=0;var g=f.getClientRects()[0];if(g.left==k.left){h=-2}else{if(k.left-g.left==-2){h=0}else{try{var a=f.ownerDocument.parentWindow.frameElement;if(a){var l=a.frameBorder.toLowerCase();if(l==""){if(a.parentElement.tagName.toLowerCase()=="frameset"){var c=a.parentElement.frameBorder.toLowerCase();if(c==""){h=-2}else{if((c=="1"||c=="yes")&&a.parentElement.border==""){h=-2}else{h=0}}}else{h=-2}}else{if(l=="1"||l=="yes"){h=-2}else{if(l=="0"||l=="no"){h=0}else{h=-2}}}}else{h=-2}}catch(i){h=-2}}}if(g.top==k.top){d=-2}else{if(k.top-g.top==-2){d=0}else{try{var a=f.ownerDocument.parentWindow.frameElement;if(a){var l=a.frameBorder.toLowerCase();if(l==""){if(a.parentElement.tagName.toLowerCase()=="frameset"){var c=a.parentElement.frameBorder.toLowerCase();if(c==""){d=-2}else{if((c=="1"||c=="yes")&&a.parentElement.border==""){d=-2}else{d=0}}}else{d=-2}}else{if(l=="1"||l=="yes"){d=-2}else{if(l=="0"||l=="no"){d=0}else{d=-2}}}}else{d=-2}}catch(i){d=-2}}}if(typeof window.dialogArguments!="undefined"){h=h+2;d=d+2}j.left=k.left+h+document.body.scrollLeft+document.documentElement.scrollLeft;j.top=k.top+d+document.body.scrollTop+document.documentElement.scrollTop}else{InfoJet_GetPosByOffset(f,j)}j.left=j.left-InfoJet_OffsetX;j.top=j.top-InfoJet_OffsetY;return j}catch(b){return null}return null}function InfoJet_GetPosByOffset(f,k){var l=null;try{l=f.getBoundingClientRect()}catch(i){}if(l!=null){var m=f.ownerDocument;var n=m.documentElement;var g=m.body;var h=n.clientLeft||g.clientLeft||0;var d=n.clientTop||g.clientTop||0;var c=window.pageXOffset||n.scrollLeft||g.scrollLeft;var a=window.pageYOffset||n.scrollTop||g.scrollTop;var b=l.left+c-h;var j=l.top+a-d;k.left=b;k.top=j}}function InfoJet_GetMarginBottom(b){if(InfoJet_IsIE()){return InfoJet_GetPixelSize(b.currentStyle.marginBottom)}else{var a=window.getComputedStyle(b,"");return parseInt(a.getPropertyValue("margin-bottom"))}}function InfoJet_GetStylePixelSize(element,ieProp,nsProp){if(InfoJet_IsIE()){var value=eval("element.currentStyle."+ieProp);return InfoJet_GetPixelSize(value)}else{var css=window.getComputedStyle(element,"");return parseInt(css.getPropertyValue(nsProp))}}function InfoJet_GetPixelSize(a){if(a.indexOf("pt")>0){if(isNaN(parseInt(a))){return 0}else{return parseInt(a)*2}}else{if(isNaN(parseInt(a))){return 0}else{return parseInt(a)}}}function InfoJet_GetBodyClientLeft(){if(document.body.clientLeft){return document.body.clientLeft+2}else{return 2+2}}function InfoJet_GetBodyClientTop(){if(document.body.clientTop){return document.body.clientTop+5}else{return 2+5}}function InfoJet_CreateField(c){var b=document.getElementById("xdoc_form");var a="<input type=hidden id="+c+" name="+c+" value=>";InfoJet_InsertAdjacentHTMLBeforeEnd(b,a);var d=document.getElementById(c);return d}function InfoJet_GetWriteOnlyField(a){var b=document.getElementById(a);if(b==null){var c=false;if(InfoJet_EnableFormFieldsCache){c=true}else{if(a.indexOf("xdoc_s_")==0){c=true}}if(c){b=InfoJet_CreateField(a)}}return b}function InfoJet_UpdateField(f){InfoJet_Changed=true;var a="xdoc"+InfoJet_GetElementId(f);var e=InfoJet_GetWriteOnlyField(a);document.getElementById("xdoc_param_old_value").value=e.value;var c=f.tagName.toLowerCase();if(c=="select"){e.value=InfoJet_GetHtmlSelectValue(f)}else{if(c=="img"){e.value=f.src}else{if(c=="input"){var d=f.type.toLowerCase();if(d=="text"||d=="password"){var b=f.getAttribute("xml_value");if(b!=null){e.value=b}else{e.value=f.value}}else{if(d=="checkbox"){if(f.checked){e.value=InfoJet_GetOnOffValue(f,true)}else{e.value=InfoJet_GetOnOffValue(f,false)}}else{if(d=="radio"){if(f.checked){e.value=InfoJet_GetOnOffValue(f,true)}}}}}else{if(c=="textarea"){var b=f.getAttribute("xml_value");if(b!=null){e.value=b}else{e.value=f.value}}else{e.value=f.innerHTML}}}}InfoJet_UpdateXDocumentDOM(e)}function InfoJet_GetOnOffValue(c,d){var a=null;if(d){a=InfoJet_XdPrefix+"onValue"}else{a=InfoJet_XdPrefix+"offValue"}var b=c.getAttribute(a);if(b!=null){return b}else{return""}}function InfoJet_HideOverBorderArrow(){InfoJet_FieldOverLeft.style.height=0;InfoJet_FieldOverRight.style.height=0;InfoJet_FieldOverTop.style.width=0;InfoJet_FieldOverBottom.style.width=0;InfoJet_ItemOverLeft.style.height=0;InfoJet_ItemOverRight.style.height=0;InfoJet_ItemOverTop.style.width=0;InfoJet_ItemOverBottom.style.width=0}function InfoJet_HideFocusBorderArrow(){InfoJet_FieldFocusLeft.style.height=0;InfoJet_FieldFocusRight.style.height=0;InfoJet_FieldFocusTop.style.width=0;InfoJet_FieldFocusBottom.style.width=0;InfoJet_ItemFocusLeft.style.height=0;InfoJet_ItemFocusRight.style.height=0;InfoJet_ItemFocusTop.style.width=0;InfoJet_ItemFocusBottom.style.width=0;InfoJet_HideFocusMenuArrow()}function InfoJet_SelectTextControlPlaceHolder(b){var a=b.getAttribute(InfoJet_XdPrefix+"ghosted");if(a!=null&&a=="true"){b.createTextRange().select()}}function InfoJet_DisableContextMenu(a){a=InfoJet_GetEvent(a);a.cancelBubble=true;a.returnValue=false}function InfoJet_GetPSVI(a){if(InfoJet_PSVITable!=null){var c=a.getAttribute("psvi_id");if(c!=null&&c.length>0){var b=InfoJet_PSVITable[c];return b}}return null}function InfoJet_GetSchemaType(b){var c=InfoJet_GetPSVI(b);if(c!=null){return c.type}var a=b.getAttribute("schema_type");if(a==null||a.length<=0){a="unknown"}return a}function InfoJet_GetSchemaNillable(b){var c=InfoJet_GetPSVI(b);if(c!=null){return c.nillable}var a=b.getAttribute("schema_nillable");if(a==null&&a.length<=0){a="unknown"}return a}function InfoJet_GetSchemaMinLength(b){var c=InfoJet_GetPSVI(b);if(c!=null){return c.minLength}var a=b.getAttribute("schema_minLength");return a}function InfoJet_GetSchemaMaxLength(b){var c=InfoJet_GetPSVI(b);if(c!=null){return c.maxLength}var a=b.getAttribute("schema_maxLength");return a}function InfoJet_CheckOnChangeTable(d){if(InfoJet_OnChangeTable!=null){for(var f in InfoJet_OnChangeTable){if(InfoJet_EndsWith(d.id,f)){var a="xdoc"+InfoJet_GetElementId(d);var e=document.getElementById(a);if(e!=null){var c={control:d,field:e};var b={newValue:e.value};return InfoJet_OnChangeTable[f].call(null,c,b)}}}}return true}function InfoJet_IsComboBoxControl(d){if(d.className!=null&&d.className.indexOf("xdComboBox")==0){var a=InfoJet_GetPreviousElement(d);if(a){var c=a.tagName.toLowerCase();if(c=="input"){if(a.className!=null&&a.className.indexOf("ComboBoxTextField")>0){return true}}}}if(d.className!=null&&d.className.indexOf("ComboBoxTextField")>0){var b=InfoJet_GetNextElement(d);if(b){var c=b.tagName.toLowerCase();if(c=="select"){if(b.className!=null&&b.className.indexOf("xdComboBox")==0){return true}}}}return false}function InfoJet_UpdateComboBox(d){if(d.className!=null&&d.className.indexOf("xdComboBox")==0){var b=InfoJet_GetPreviousElement(d);if(b!=null){b.value=d.options[d.selectedIndex].text}return true}else{if(d.className!=null&&d.className.indexOf("ComboBoxTextField")>0){var a=InfoJet_GetNextElement(d);for(var c=0;c<a.options.length;c++){var e=a.options[c].value;if(e!=null&&e==d.value){a.options[c].selected=true}else{a.options[c].selected=false}}a.value=d.value;return true}else{return false}}}function InfoJet_OnControlChange(b,d){var c=d.getAttribute("postbacked");if(c!=null&&c=="true"){return}InfoJet_MoveProgress2ControlPosition(d);InfoJet_TrimByMaxLength(d);var a=InfoJet_IsComboBoxControl(d);if(a){InfoJet_UpdateComboBox(d)}InfoJet_CheckGhosted(d);InfoJet_CheckPostback(d,a,true)}function InfoJet_CheckPostback(g,e,a){var d=InfoJet_CheckLogicPostback(g,e);var c=false;if(a){c=InfoJet_UpdateBySchema(g,d);if(!InfoJet_CheckOnChangeTable(g)){return}if(typeof(InfoJetCustom_OnControlChange)!="undefined"){if(!InfoJetCustom_OnControlChange(g)){return}}}var b=false;var h=g.getAttribute("InfoJet_ForcePostback");if(h!=null&&h.toLowerCase()=="true"){b=true}var f=g.getAttribute("InfoJet_ForcePostbackOnce");if(f!=null&&f.toLowerCase()=="true"){b=true;g.removeAttribute("InfoJet_ForcePostbackOnce")}if(d||c||b){InfoJet_CheckOldValueState(g);if(InfoJet_UseAjax){InfoJet_AJAXonField(g)}else{InfoJet_RefreshAfaterUpdate(g)}}}function InfoJet_CheckLogicPostback(d,a){var b=d.getAttribute("logic_tags");if(b!=null&&b.length>0){return true}var c=d.getAttribute("duplicate_id");if(c!=null&&c=="yes"){if(InfoJet_IsRadioButton(d)){}else{if(a){}else{return true}}}var e=d.getAttribute("server_control");if(e==null||e=="yes"){return true}return false}function InfoJet_UpdateBySchema(e,d){var b=InfoJet_GetSchemaType(e);if(b=="unknown"){InfoJet_XmlValueFormatted(false);InfoJet_UpdateField(e);return true}var c=InfoJet_DataFmt(e);if(c==-1&&b=="string"){c=1}if(c==0){InfoJet_XmlValueFormatted(false);InfoJet_UpdateField(e);return true}else{if(c==1){var a=InfoJet_GetSchemaNillable(e);var f=InfoJet_GetControlValue(e);if(f==null){return false}if(!d){if(f.length>0){if(a=="true"){InfoJet_RemoveError(e.id,"schema");InfoJet_HideError(e.id)}else{if(InfoJet_CheckSchemaLength(e,f)){InfoJet_RemoveError(e.id,"schema");InfoJet_HideError(e.id)}else{InfoJet_AddSchemaError(e.id);InfoJet_ShowSchemaError(e.id)}}}else{if(a=="true"){InfoJet_RemoveError(e.id,"schema");InfoJet_HideError(e.id)}else{if(b=="string"||b=="anyURI"){if(InfoJet_CheckSchemaLength(e,f)){InfoJet_RemoveError(e.id,"schema");InfoJet_HideError(e.id)}else{InfoJet_AddSchemaError(e.id);InfoJet_ShowSchemaError(e.id)}}else{InfoJet_AddSchemaError(e.id);InfoJet_ShowSchemaError(e.id)}}}}InfoJet_XmlValueFormatted(true);InfoJet_UpdateField(e);return false}else{if(!d){InfoJet_AddSchemaError(e.id);InfoJet_ShowSchemaError(e.id)}InfoJet_XmlValueFormatted(false);InfoJet_UpdateField(e);return false}}return false}function InfoJet_XmlValueFormatted(a){if(a){document.getElementById("xdoc_param_xml_value_formatted").value="1"}else{document.getElementById("xdoc_param_xml_value_formatted").value="0"}}function InfoJet_IsRadioButton(c){var a=c.tagName.toLowerCase();if(a=="input"){var b=c.type.toLowerCase();if(b=="radio"){return true}}return false}function InfoJet_GetControlValue(c){var a=c.tagName.toLowerCase();if(a=="select"){return InfoJet_GetHtmlSelectValue(c)}else{if(a=="img"){return c.src}else{if(a=="input"){var b=c.type.toLowerCase();if(b=="text"||b=="password"){return c.value}else{if(b=="checkbox"){if(c.checked){return InfoJet_GetOnOffValue(c,true)}else{return InfoJet_GetOnOffValue(c,false)}}else{if(b=="radio"){if(c.checked){return InfoJet_GetOnOffValue(c,true)}}}}}else{if(a=="textarea"){return c.value}else{return c.innerHTML}}}}}function InfoJet_CheckSchemaLength(g,h){var d=true;var c=true;var f=InfoJet_GetSchemaMinLength(g);if(f!=null&&f.length>0){if(f!="unbounded"){var b=parseInt(f);if(h.length<b){d=false}}}var e=InfoJet_GetSchemaMaxLength(g);if(e!=null&&e.length>0){if(e!="unbounded"){var a=parseInt(e);if(h.length>a){c=false}}}return d&&c}function InfoJet_CheckGhosted(c){if(InfoJet_IsTextControl(c)){var b=c.getAttribute(InfoJet_XdPrefix+"ghosted");if(b!=null&&b=="true"){c.setAttribute(InfoJet_XdPrefix+"ghosted","false");var a=c.getAttribute("noneghostedcolor");if(a!=null){c.style.color=a}}}}function InfoJet_OnLinkedPictureClick(event,linkedPicture){if(typeof(InfoJetCustom_OnLinkedPictureClick)!="undefined"){eval("InfoJetCustom_OnLinkedPictureClick( event , linkedPicture );")}else{var oldSrc="";if(linkedPicture.tagName.toLowerCase()=="img"){oldSrc=linkedPicture.src}window.showModalDialog(InfoJet_WebContext+"js/linkpicture_dialog.htm",new Array(window,linkedPicture,oldSrc),"dialogWidth:470px;dialogHeight:150px;help:no;");if(linkedPicture.linkPicturePath){var src=linkedPicture.linkPicturePath.substr(5);linkedPicture.removeAttribute("linkPicturePath");if(src!=null){if(InfoJet_EnablePlaceholderUI){var fieldId="xdoc"+InfoJet_GetElementId(linkedPicture);var xmlField=InfoJet_GetWriteOnlyField(fieldId);xmlField.value=src;InfoJet_PostbackOnControl(linkedPicture)}else{linkedPicture.src=src;InfoJet_UpdateField(linkedPicture)}}}}}function InfoJet_OnInlinePictureClick(event,inlinePicture){var disableEditing=inlinePicture.getAttribute(InfoJet_XdPrefix+"disableEditing");if(disableEditing!=null&&disableEditing.toLowerCase()=="yes"){return}if(typeof(InfoJetCustom_OnInlinePictureClick)!="undefined"){var formId=document.getElementById("xdoc_param_form_id").value;eval("InfoJetCustom_OnInlinePictureClick( event , inlinePicture, formId );")}else{var formId=document.getElementById("xdoc_param_form_id").value;var uploadedPicture=window.showModalDialog(InfoJet_WebContext+"js/uploadpicture_dialog.htm",new Array(window,inlinePicture,formId),"dialogWidth:470px;dialogHeight:150px;help:no;");if(uploadedPicture!=null){if(InfoJet_EnablePlaceholderUI){var pureId=InfoJet_GetPureId(inlinePicture.id);var file=InfoJet_GetWriteOnlyField("xdoc"+pureId);file.value=uploadedPicture.content;InfoJet_PostbackOnControl(inlinePicture)}else{InfoJet_LinkUploadedPicture(inlinePicture,uploadedPicture);var psvi=InfoJet_GetPSVI(inlinePicture);if(psvi!=null&&psvi.type=="base64Binary"&&psvi.nillable=="false"){InfoJet_RemoveError(inlinePicture.id,"schema");InfoJet_HideError(inlinePicture.id)}window.setTimeout("InfoJet_RelayoutFieldStyles();InfoJet_ShowFieldBorder( document.getElementById('"+inlinePicture.id+"'), 'xdoc_field_focus' );",500)}}}}function InfoJet_LinkUploadedPicture(b,c){if(b.src==null){b=document.getElementById(a+",1")}var d=c.path;b.src=d;var a=InfoJet_GetPureId(b.id);var e=InfoJet_GetWriteOnlyField("xdoc"+a);e.value=c.content;InfoJet_UpdateXDocumentDOM(e)}function InfoJet_OnInkPictureClick(a,g){var f=g.getAttribute(InfoJet_XdPrefix+"disableEditing");if(f!=null&&f.toLowerCase()=="yes"){return}var i=document.getElementById("xdoc_param_form_id").value;var e=InfoJet_GetPreviousElement(g);if(e!=null){var h=e.getAttribute("isBackground");if(h==null||h!="true"){e=null}}var b=g.offsetWidth+50;var j=g.offsetHeight+65;if(b>800){b=800}if(j>700){j=700}if(b<270){b=270}if(j<250){j=250}var d=window.showModalDialog(InfoJet_WebContext+"js/editink_dialog.htm",new Array(window,e,g,i),"dialogWidth:"+b+"px;dialogHeight:"+j+"px;resizable:yes;help:no;");if(d!=null){InfoJet_LinkUploadedPicture(g,d);var c=InfoJet_GetPSVI(g);if(c!=null&&c.type=="base64Binary"&&c.nillable=="false"){InfoJet_RemoveError(g.id,"schema");InfoJet_HideError(g.id)}}}function InfoJet_SetInkPictures(a,b){if(InfoJet_CurrentDialog!=null){InfoJet_CurrentDialog.SetInkPictures(a,b)}}function InfoJet_IsAncestorElementDisabled(b,c){var a=InfoJet_GetParent(b);while(a){if(a.tagName){if(a.tagName.toLowerCase()==c){if(a.disabled){return true}}a=InfoJet_GetParent(a)}else{break}}return false}var InfoJet_SignatureHtmlElement=null;function InfoJet_OnSignatureButtonClick(d,c){if(InfoJet_CheckClickFrequently(c)){return}InfoJet_SignatureHtmlElement=document.getElementById("xdoc_view");var e=c.getAttribute("dsig_block");var f=document.getElementById("xdoc_param_dsig_block");if(f==null){var a=document.getElementById("xdoc_form");var b="<input type=hidden id=xdoc_param_dsig_block name=xdoc_param_dsig_block />";InfoJet_InsertAdjacentHTMLBeforeEnd(a,b);f=document.getElementById("xdoc_param_dsig_block")}f.value=e;document.getElementById("xdoc_param_command").value="Update_PrepareSignature";InfoJet_MoveProgress2ControlPosition(c);InfoJet_Submit()}function InfoJet_ToSign(a){window.showModalDialog(InfoJet_WebContext+"js/signature_dialog.htm",new Array(window,a,true),"dialogWidth:450px;dialogHeight:530px;resizable:yes;help:no;")}function InfoJet_OnSigned(c,f){var a=document.getElementById("xdoc_form");var g=document.getElementById("xdoc_param_dsig_block");if(g==null){var d="<input type=hidden id=xdoc_param_dsig_block name=xdoc_param_dsig_block />";InfoJet_InsertAdjacentHTMLBeforeEnd(a,d);g=document.getElementById("xdoc_param_dsig_block")}g.value=c;var e=document.getElementById("xdoc_param_dsig_xml");if(e==null){var b="<input type=hidden id=xdoc_param_dsig_xml name=xdoc_param_dsig_xml />";InfoJet_InsertAdjacentHTMLBeforeEnd(a,b);e=document.getElementById("xdoc_param_dsig_xml")}e.value=f;document.getElementById("xdoc_param_command").value="Update_AddSignature";InfoJet_Submit()}function InfoJet_DeleteSignature(d){if(InfoJet_CheckClickFrequently(d)){return}if(window.confirm("Do you confirm to delete this signature?")){var e=InfoJet_GetParent(d);var a=document.getElementById("xdoc_form");var c=document.getElementById("xdoc_param_dsig_sigid");if(c==null){var b="<input type=hidden id=xdoc_param_dsig_sigid name=xdoc_param_dsig_sigid />";InfoJet_InsertAdjacentHTMLBeforeEnd(a,b);c=document.getElementById("xdoc_param_dsig_sigid")}c.value=InfoJet_GetPureId(e.id);document.getElementById("xdoc_param_command").value="Update_DeleteSignature";InfoJet_MoveProgress2ControlPosition(d);InfoJet_Submit()}}function InfoJet_ShowSignatureDetails(d){if(InfoJet_CheckClickFrequently(d)){return}var e=InfoJet_GetParent(d);var a=document.getElementById("xdoc_form");var c=document.getElementById("xdoc_param_dsig_sigid");if(c==null){var b="<input type=hidden id=xdoc_param_dsig_sigid name=xdoc_param_dsig_sigid />";InfoJet_InsertAdjacentHTMLBeforeEnd(a,b);c=document.getElementById("xdoc_param_dsig_sigid")}c.value=InfoJet_GetPureId(e.id);document.getElementById("xdoc_param_command").value="Update_ViewSignature";InfoJet_MoveProgress2ControlPosition(d);InfoJet_Submit()}function InfoJet_ViewSignature(a){window.showModalDialog(InfoJet_WebContext+"js/signature_dialog.htm",new Array(window,a,false),"dialogWidth:450px;dialogHeight:470px;resizable:yes;help:no;")}function InfoJet_OnPNGPickerClick(c,e){if(InfoJet_IsAncestorElementDisabled(e,"span")){return}var i=InfoJet_GetParent(InfoJet_GetParent(e));var d=i.getAttribute("pngId");var k=i.getAttribute("allowMultiple");var h=window.showModalDialog(InfoJet_WebContext+"js/pngpicker_dialog.htm",new Array(window,d,k),"dialogWidth:570px;dialogHeight:390px;resizable:yes;help:no;");if(h){InfoJet_FocusItemIndex=-1;var g=InfoJet_GetElements(InfoJet_GetElements(i)[0])[0];InfoJet_FocusControlId=g.id;var j=document.getElementById("xdoc_form");var b="<input type=hidden id=xdoc_param_png_added_xml name=xdoc_param_png_added_xml />";InfoJet_InsertAdjacentHTMLBeforeEnd(j,b);document.getElementById("xdoc_param_png_added_xml").value=h;var f="<input type=hidden id=xdoc_param_png_context_id name=xdoc_param_png_context_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(j,f);document.getElementById("xdoc_param_png_context_id").value=i.id;var a="<input type=hidden id=xdoc_param_png_id name=xdoc_param_png_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(j,a);document.getElementById("xdoc_param_png_id").value=d;document.getElementById("xdoc_param_command").value="Update_AddPrincipals";InfoJet_MoveProgress2ControlPosition(i);InfoJet_Submit()}}function InfoJet_ShowPNGPrincipals(a){if(InfoJet_CurrentDialog!=null){InfoJet_CurrentDialog.ShowPrincipals(a)}}function InfoJet_OnPNGItemClick(c){if(InfoJet_IsAncestorElementDisabled(c,"span")){return false}var d=InfoJet_GetParent(InfoJet_GetParent(InfoJet_GetParent(c)));var b=InfoJet_GetFirstChild(InfoJet_GetLastChild(d));if(b.disabled){return false}c.style.backgroundColor="blue";c.style.color="#FFFFFF";var a=InfoJet_GetElements(c)[0];a.style.display="";return false}function InfoJet_OnPNGItemKeyDown(c,b){if(InfoJet_IsAncestorElementDisabled(b,"span")){return}c=InfoJet_GetEvent(c);if(c.keyCode==46){var a=InfoJet_GetElements(b)[0];InfoJet_OnPNGItemDelete(a)}}function InfoJet_OnPNGItemBlur(b){b.style.backgroundColor="";b.style.color="#000000";var a=InfoJet_GetElements(b)[0];a.style.display="none"}function InfoJet_OnPNGItemDelete(b){if(InfoJet_IsAncestorElementDisabled(b,"span")){return}InfoJet_FocusItemIndex=-1;var e=InfoJet_GetParent(InfoJet_GetParent(b));InfoJet_FocusControlId=e.id;var a=document.getElementById("xdoc_form");var f=InfoJet_GetParent(InfoJet_GetParent(InfoJet_GetParent(InfoJet_GetParent(b))));var d="<input type=hidden id=xdoc_param_png_context_id name=xdoc_param_png_context_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(a,d);document.getElementById("xdoc_param_png_context_id").value=f.id;var c="<input type=hidden id=xdoc_param_png_account_id name=xdoc_param_png_account_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(a,c);document.getElementById("xdoc_param_png_account_id").value=b.getAttribute("acccountId");var g=f.getAttribute("pngId");var h="<input type=hidden id=xdoc_param_png_id name=xdoc_param_png_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(a,h);document.getElementById("xdoc_param_png_id").value=g;document.getElementById("xdoc_param_command").value="Update_DeletePrincipal";InfoJet_MoveProgress2ControlPosition(f);InfoJet_Submit();return false}function InfoJet_OnEXIPickerClick(c,h){if(InfoJet_IsAncestorElementDisabled(h,"span")){return}var k=InfoJet_GetParent(InfoJet_GetParent(h));var l=k.getAttribute("exiId");var i=k.getAttribute("multiItem");var a=k.getAttribute("pickerDialogTitle");var f=window.showModalDialog(InfoJet_WebContext+"js/exipicker_dialog.htm",new Array(window,l,i,a),"dialogWidth:570px;dialogHeight:390px;resizable:yes;help:no;");if(f){InfoJet_FocusItemIndex=-1;var e=InfoJet_GetElements(InfoJet_GetElements(k)[0])[0];InfoJet_FocusControlId=e.id;var j=document.getElementById("xdoc_form");var b="<input type=hidden id=xdoc_param_exi_added_xml name=xdoc_param_exi_added_xml />";InfoJet_InsertAdjacentHTMLBeforeEnd(j,b);document.getElementById("xdoc_param_exi_added_xml").value=f;var d="<input type=hidden id=xdoc_param_exi_context_id name=xdoc_param_exi_context_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(j,d);document.getElementById("xdoc_param_exi_context_id").value=k.id;var g="<input type=hidden id=xdoc_param_exi_id name=xdoc_param_exi_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(j,g);document.getElementById("xdoc_param_exi_id").value=l;document.getElementById("xdoc_param_command").value="Update_AddEXIItems";InfoJet_MoveProgress2ControlPosition(k);InfoJet_Submit()}}function InfoJet_ShowEXIItems(a){if(InfoJet_CurrentDialog!=null){InfoJet_CurrentDialog.ShowItems(a)}}function InfoJet_OnEXIItemClick(c){if(InfoJet_IsAncestorElementDisabled(c,"span")){return false}var d=InfoJet_GetParent(InfoJet_GetParent(InfoJet_GetParent(c)));var b=InfoJet_GetFirstChild(InfoJet_GetLastChild(d));if(b.disabled){return false}c.style.backgroundColor="blue";c.style.color="#FFFFFF";var a=InfoJet_GetElements(c)[0];a.style.display="";return false}function InfoJet_OnEXIItemKeyDown(c,b){if(InfoJet_IsAncestorElementDisabled(b,"span")){return}c=InfoJet_GetEvent(c);if(c.keyCode==46){var a=InfoJet_GetElements(b)[0];InfoJet_OnEXIItemDelete(a)}}function InfoJet_OnEXIItemBlur(b){b.style.backgroundColor="";b.style.color="#000000";var a=InfoJet_GetElements(b)[0];a.style.display="none"}function InfoJet_OnEXIItemDelete(d){if(InfoJet_IsAncestorElementDisabled(d,"span")){return}InfoJet_FocusItemIndex=-1;var e=InfoJet_GetParent(InfoJet_GetParent(d));InfoJet_FocusControlId=e.id;var g=document.getElementById("xdoc_form");var f=InfoJet_GetParent(InfoJet_GetParent(InfoJet_GetParent(InfoJet_GetParent(d))));var c="<input type=hidden id=xdoc_param_exi_context_id name=xdoc_param_exi_context_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(g,c);document.getElementById("xdoc_param_exi_context_id").value=f.id;var b="<input type=hidden id=xdoc_param_exi_entity_id1 name=xdoc_param_exi_entity_id1 />";InfoJet_InsertAdjacentHTMLBeforeEnd(g,b);document.getElementById("xdoc_param_exi_entity_id1").value=d.getAttribute("entityId1");var a="<input type=hidden id=xdoc_param_exi_entity_id2 name=xdoc_param_exi_entity_id2 />";InfoJet_InsertAdjacentHTMLBeforeEnd(g,a);document.getElementById("xdoc_param_exi_entity_id2").value=d.getAttribute("entityId2");var j="<input type=hidden id=xdoc_param_exi_entity_id3 name=xdoc_param_exi_entity_id3 />";InfoJet_InsertAdjacentHTMLBeforeEnd(g,j);document.getElementById("xdoc_param_exi_entity_id3").value=d.getAttribute("entityId3");var i="<input type=hidden id=xdoc_param_exi_entity_id4 name=xdoc_param_exi_entity_id4 />";InfoJet_InsertAdjacentHTMLBeforeEnd(g,i);document.getElementById("xdoc_param_exi_entity_id4").value=d.getAttribute("entityId4");var h="<input type=hidden id=xdoc_param_exi_entity_id5 name=xdoc_param_exi_entity_id5 />";InfoJet_InsertAdjacentHTMLBeforeEnd(g,h);document.getElementById("xdoc_param_exi_entity_id5").value=d.getAttribute("entityId5");document.getElementById("xdoc_param_command").value="Update_DeleteEXIItem";InfoJet_MoveProgress2ControlPosition(f);InfoJet_Submit();return false}function InfoJet_OnDropdownListPickerClick(a,e){var i=InfoJet_GetParent(e);var g=i.getAttribute("dropdownListId");var f=InfoJet_GetLastChild(i);if(g){var k=document.getElementById("xdoc_form");var h=document.getElementById("xdoc_param_dropdownlist_id");if(h==null){var c="<input type=hidden id=xdoc_param_dropdownlist_id name=xdoc_param_dropdownlist_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(k,c);h=document.getElementById("xdoc_param_dropdownlist_id")}h.value=g;var d=document.getElementById("xdoc_param_dropdownlist_context_id");if(d==null){var j="<input type=hidden id=xdoc_param_dropdownlist_context_id name=xdoc_param_dropdownlist_context_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(k,j);d=document.getElementById("xdoc_param_dropdownlist_context_id")}d.value=InfoJet_GetElementId(f);var l=document.getElementById("xdoc_param_dropdownlist_button_id");if(l==null){var b="<input type=hidden id=xdoc_param_dropdownlist_button_id name=xdoc_param_dropdownlist_button_id />";InfoJet_InsertAdjacentHTMLBeforeEnd(k,b);l=document.getElementById("xdoc_param_dropdownlist_button_id")}l.value=e.id;document.getElementById("xdoc_param_command").value="Update_LoadDropdownListItems";InfoJet_MoveProgress2ControlPosition(e);InfoJet_Submit()}}function InfoJet_PopupDropdownList(f,c){var e=document.getElementById(f);var d=InfoJet_GetParent(e);var b=document.getElementById("xdoc_popup");if(b==null){var g="<div id='xdoc_popup' style='width:0px;height:0px;position:absolute;z-index:99;background:#FFFFFF;padding:0px;margin:0px;'>"+c+"</div>";InfoJet_InsertAdjacentHTMLBeforeEnd(InfoJet_Container,g);b=document.getElementById("xdoc_popup")}b.innerHTML=c;var h=InfoJet_GetPos(d);b.style.left=h.left;b.style.top=h.top+d.offsetHeight;b.style.display="";var a=InfoJet_GetFirstChild(b);a.setAttribute("buttonId",f);if(a.offsetWidth<d.offsetWidth){a.style.width=d.offsetWidth}a.focus()}function InfoJet_HidePopupDropdownList(a){var b=InfoJet_GetParent(a);b.style.display="none";b.innerHTML="";var d=a.getAttribute("buttonId");var c=document.getElementById(d);c.focus()}function InfoJet_UpdatePopupDropdownList(m){var j="";var d="";if(m.selectedIndex>=0){var c=m.options[m.selectedIndex];j=c.value;d=c.text}var k=m.getAttribute("buttonId");var g=document.getElementById(k);var l=InfoJet_GetParent(g);var b=InfoJet_GetFirstChild(l);b.innerHTML=d;var h=InfoJet_GetLastChild(l);var a=h.options.length;for(var e=0;e<a;e++){h.options.remove(0)}var f=new Option(d,j);h.options.add(f);h.selectedIndex=0;InfoJet_OnControlChange(null,h)}function InfoJet_OnPopupDropdownListBlur(a){InfoJet_HidePopupDropdownList(a)}function InfoJet_OnPopupDropdownListKeyPress(b,a){if(b.keyCode==27){InfoJet_HidePopupDropdownList(a)}else{if(b.keyCode==13){InfoJet_UpdatePopupDropdownList(a);InfoJet_HidePopupDropdownList(a)}}}function InfoJet_OnPopupDropdownListClick(b,a){InfoJet_UpdatePopupDropdownList(a);InfoJet_HidePopupDropdownList(a)}function InfoJet_OnMenuClick(c,d){if(d.getAttribute("type")=="group"){return}InfoJet_HiddenAllGroupMenu();var f=document.getElementById("xdoc_menu_focus_arrow");f.style.display="none";var h=d.getAttribute("action");var l=d.getAttribute("component");if(h!=null){if(h=="switchView"){var m=d.getAttribute("component");InfoJet_DoSwitchView(m)}else{if(h=="noErrorFormatting"){InfoJet_CheckErrorFormatting(d)}else{if(h=="printableVersion"){InfoJet_OpenPrintableVersion(null)}else{if(h=="attach"&&l=="xFileAttachment"){var k=f.getAttribute("itemId");var a=document.getElementById(k);InfoJet_AttachFile(a);InfoJet_OnFocus(c,a,"control")}else{if(h=="open"&&l=="xFileAttachment"){var k=f.getAttribute("itemId");var a=document.getElementById(k);if(a.href==null){a=document.getElementById(k+",1")}if(a!=null){var b=a.href;if(b=="javascript:void(0)"){b=a.getAttribute("fileHref")}if(b!=null&&b!="javascript:void(0)"){window.open(b)}}}else{if(h=="saveAs"&&l=="xFileAttachment"){var k=f.getAttribute("itemId");var a=document.getElementById(k);if(a.href==null){a=document.getElementById(k+",1")}if(a!=null){var b=a.href;if(b=="javascript:void(0)"){b=a.getAttribute("fileHref")}if(b!=null&&b!="javascript:void(0)"){if(InfoJet_SaveAsPage!=null){window.open(InfoJet_SaveAsPage+"?file="+b)}else{InfoJet_SaveAsWindow=window.open(b);try{if(InfoJet_IsImage(b)){window.setTimeout("if( InfoJet_SaveAsWindow != null ){ InfoJet_SaveAsWindow.document.execCommand( 'SaveAs' ); }",1000)}else{InfoJet_SaveAsWindow.document.execCommand("SaveAs")}}catch(i){}}}}}else{if(h=="remove"&&l=="xFileAttachment"){var k=f.getAttribute("itemId");var a=document.getElementById(k);if(a.href==null){a=document.getElementById(k+",1")}if(a!=null){InfoJet_RemoveFile(a);InfoJet_OnFocus(c,a,"control")}}else{var k=f.getAttribute("itemId");var g=d.getAttribute("xmlToEdit");var j=d.getAttribute("component")+"::"+d.getAttribute("action");InfoJet_DoXmlToEditAction(k,g,j)}}}}}}}}}function InfoJet_IsImage(a){var c=a.lastIndexOf(".");if((c>0)&&(c<a.length-1)){var b=a.substr(c+1).toLowerCase();if(b=="gif"||b=="jpg"||b=="bmp"||b=="emf"||b=="exif"||b=="icon"||b=="png"||b=="tiff"||b=="wmf"){return true}}return false}function InfoJet_OnMenuArrowPoint(b,c,a){b=InfoJet_GetEvent(b);if(a=="arrow"){var d=document.getElementById("xdoc_menu_focus_arrow");c=document.getElementById(d.getAttribute("itemId"))}return InfoJet_ShowContextMenu(b,c,a)}function InfoJet_OnContextMenu(b,c){if(!InfoJet_ReplaceBrowserContextMenu){b.cancelBubble=true;b.returnValue=true;return true}InfoJet_HiddenAllGroupMenu();if(c.disabled){b.cancelBubble=true;b.returnValue=true;return true}b=InfoJet_GetEvent(b);var a=c.tagName.toLowerCase();if(a!="div"&&a!="table"&&a!="tr"&&a!="td"){var d=c.getAttribute("isFileAttachment");if(d!="true"){b.cancelBubble=true;b.returnValue=true;return true}}InfoJet_OnFocus(b,c,"common");return InfoJet_ShowContextMenu(b,c,"arrow")}function InfoJet_ShowContextMenu(b,a,f){var c=InfoJet_RefreshXmlToEditItem(a,true);var h="";if(c!=null){h=c.id}var e=new Array();if(f=="arrow"){InfoJet_GetMenuContextIds(e,a)}else{if(f=="point"){e[e.length]=document.getElementById("xdoc_data_root_element_id").innerHTML}}if(e.length>=1){InfoJet_HiddenAllGroupMenu();var k=InfoJet_ShowMenuByContext("",e,h,f);var i=document.getElementById("xdoc_menu");if(k>0){var j=document.getElementById("xdoc_param_view_id").value;var i=document.getElementById("xdoc.contextmenu.group"+j);var d=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;var g=b.clientY+document.body.scrollTop+document.documentElement.scrollTop;i.style.left=d;i.style.top=g;i.style.display="block";InfoJet_HideSelects(i,d,g);b.cancelBubble=true;b.returnValue=false}return false}else{return true}}function InfoJet_HideSelects(o,d,n){if(InfoJet_IsIE7()){return}InfoJet_Selects=new Array();var j=d;var f=n;var h=d+o.offsetWidth;var e=n+o.offsetHeight;var k=document.getElementsByTagName("select");for(var g=0;g<k.length;g++){var q=k[g];var m=InfoJet_GetPos(q);if(m==null){return}var c=m.left;var p=m.top;var b=m.left+q.offsetWidth;var l=m.top+q.offsetHeight;if(!((j>b)||(c>h)||(f>l)||(p>e))){var a=q.style.visibility;if(!a){a=q.currentStyle.visibility}q.setAttribute("InfoJet_Visibility",a);q.style.visibility="hidden";InfoJet_Selects[InfoJet_Selects.length]=q}}}function InfoJet_ShowSelects(){if(InfoJet_IsIE7()){return}if(InfoJet_Selects!=null){for(var b=0;b<InfoJet_Selects.length;b++){var a=InfoJet_Selects[b];a.style.visibility=a.getAttribute("InfoJet_Visibility")}}InfoJet_Selects=null}function InfoJet_GetMenuContextIds(a,b){if(b==null||b.id=="xdoc_view"){return}var c=InfoJet_GetElementId(b);if(c!=null&&c.indexOf("_0_")==0){a[a.length]=c}InfoJet_GetMenuContextIds(a,InfoJet_GetParent(b))}function InfoJet_ShowMenuByContext(o,e,l,k){var n=document.getElementById("xdoc_param_view_id").value;var q=0;var h=InfoJet_GetParentStyles(InfoJet_ItemElement);for(var f=0;true;f++){var a=o+f;var j=a+".menu"+n;var b=document.getElementById(j);if(b!=null){var d=b.getAttribute("action");var g=(d!=null)&&(d=="none");var m=(d!=null)&&(d=="switchView");var c=(d!=null)&&(d=="printableVersion");var p=(d!=null)&&(d=="noErrorFormatting");if(g&&q>0){b.style.display="block"}else{if(InfoJet_IsShowMenu(b,e,l,h)){b.style.display="block";q++}else{if(m||c||p){b.style.display="block";q++}else{b.style.display="none"}}}}else{break}}return q}function InfoJet_GetParentStyles(a){var d=new Array();var c=InfoJet_GetParent(a);while(c!=null){var b=c.style.cssText;if(b!=null&&b.length>0){d.push(b)}c=InfoJet_GetParent(c);if(c!=null&&c.id=="xdoc_view"){break}}return d}function InfoJet_IsShowMenu(b,e,n,l){if(b.getAttribute("type")=="group"){return true}var h=e[0];var c=b.getAttribute("xmlToEdit");var o=b.getAttribute("component");var f=o+"-"+c+"-editing: disabled";for(var g=0;g<l.length;g++){var p=l[g];if(p.indexOf(f)>0){return false}}var d=b.getAttribute("action");if(o=="xReplace"){if(d=="replace"){var j=document.getElementById(c+"_container").innerHTML;if(InfoJet_IsArrayIdInContextIds(j,e)&&InfoJet_IsIdInArray(h,c+"_item")){return true}else{return false}}}else{if(o=="xOptional"){if(d=="insert"){if(InfoJet_IsIdInArray(h,c+"_container")&&InfoJet_IdArrayIdCount(c+"_item")<=0){return true}else{return false}}else{if(d=="remove"){var j=document.getElementById(c+"_container").innerHTML;if(InfoJet_IsArrayIdInContextIds(j,e)&&InfoJet_IsIdInArray(h,c+"_item")){return true}else{return false}}}}else{if(o=="xCollection"){if(d=="insert"){if(InfoJet_IsIdInArray(h,c+"_container")){return true}else{return false}}else{if(d=="insertBefore"){var j=document.getElementById(c+"_container").innerHTML;if(InfoJet_IsArrayIdInContextIds(j,e)&&InfoJet_IsIdInArray(h,c+"_item")){return true}else{return false}}else{if(d=="insertAfter"){var j=document.getElementById(c+"_container").innerHTML;if(InfoJet_IsArrayIdInContextIds(j,e)&&InfoJet_IsIdInArray(h,c+"_item")){return true}else{return false}}else{if(d=="remove"){var j=document.getElementById(c+"_container").innerHTML;if(InfoJet_IsArrayIdInContextIds(j,e)&&InfoJet_IsIdInArray(h,c+"_item")){return true}else{return false}}else{if(d=="removeAll"){if(InfoJet_IsIdInArray(h,c+"_container")&&InfoJet_IdArrayIdCount(c+"_item")>0){return true}else{return false}}}}}}}else{if(o=="xFileAttachment"){n=InfoJet_GetPureId(n);if(InfoJet_IsIdInArray(n,c+"_item")){if(InfoJet_EnablePlaceholderUI){if(d=="attach"||d=="remove"){var a=document.getElementById(n);var k=a.getAttribute(InfoJet_XdPrefix+"disableEditing");if(k!=null&&k.toLowerCase()=="yes"){return false}if(a.disabled){return false}}}else{var m=InfoJet_GetParent(document.getElementById(n));if(m==null||m.getAttribute(InfoJet_XdPrefix+"disableEditing")==null){m=InfoJet_GetParent(document.getElementById(n+",1"))}if(m!=null){var k=m.getAttribute(InfoJet_XdPrefix+"disableEditing");if(k!=null&&k.toLowerCase()=="yes"){if(d=="attach"||d=="remove"){return false}}}}return true}else{return false}}}}}return false}function InfoJet_IsArrayIdInContextIds(f,e){var d=f.split(";");for(var b=0;b<d.length;b++){var h=d[b];for(var g=0;g<e.length;g++){var a=e[g];if(h==a){return true}}}return false}function InfoJet_IdArrayIdCount(c){var b=document.getElementById(c).innerHTML;if(b.length<=0){return 0}else{if(b.indexOf(";")){return 1}else{var a=b.split(";");return a.length}}}function InfoJet_OnClick(f,g,e){InfoJet_HiddenAllGroupMenu();InfoJet_HideBorder("xdoc_item_focus");if(!InfoJet_BrowserQuick){InfoJet_HideBorder("xdoc_field_focus")}f=InfoJet_GetEvent(f);InfoJet_OnFocus(f,g,e,true);var c=InfoJet_GetMultiSelectListItemXmlToEditInfo(g);if(c!=null&&c.xmlToEdit!=null&&c.xmlToEdit.length>0&&c.contextId!=null&&c.contextId.length>0){InfoJet_MoveProgress2ControlPosition(g);InfoJet_OldValueState.boolValue=!g.checked;InfoJet_OldValueState.valid=true;InfoJet_RefreshContext(g);document.getElementById("xdoc_param_xml_to_edit_name").value=c.xmlToEdit;var a=document.getElementById("xdoc_form");var b="<input type=hidden id=xdoc_param_multi_select_list_item_value name=xdoc_param_multi_select_list_item_value>";InfoJet_InsertAdjacentHTMLBeforeEnd(a,b);var h=g.getAttribute(InfoJet_XdPrefix+"onValue");document.getElementById("xdoc_param_multi_select_list_item_value").value=h;var d="<input type=hidden id=xdoc_param_multi_select_list_context_id name=xdoc_param_multi_select_list_context_id>";InfoJet_InsertAdjacentHTMLBeforeEnd(a,d);document.getElementById("xdoc_param_multi_select_list_context_id").value=c.contextId;if(g.checked){document.getElementById("xdoc_param_xml_to_edit_action").value="xTextList::newItem"}else{document.getElementById("xdoc_param_xml_to_edit_action").value="xTextList::deleteItem"}document.getElementById("xdoc_param_command").value="Update_XmlToEdit";InfoJet_Submit()}else{if(e!=null&&e=="control"&&g.id!=null&&(g.id.indexOf("_0_")==0||g.id.indexOf("_s_")==0)&&InfoJet_IsButtonTypeInput(g)){InfoJet_OnControlChange(f,g)}}}function InfoJet_GetMultiSelectListItemXmlToEditInfo(f){var b=f.tagName.toLowerCase();if(b=="input"){var c=f.getAttribute("type");if(c!=null){c=c.toLowerCase();if(c=="checkbox"){var a=InfoJet_GetParent(f);if(a.className=="xdMultiSelectListItem"){var d=InfoJet_GetParent(a);var e={xmlToEdit:"",contextId:""};e.xmlToEdit=d.getAttribute("xmlToEdit");e.contextId=d.getAttribute("contextId");return e}}}}return null}function InfoJet_IsButtonTypeInput(c){var a=c.tagName.toLowerCase();if(a=="input"){var b=c.getAttribute("type");if(b!=null){b=b.toLowerCase();if(b=="checkbox"||b=="radio"){return true}}}return false}function InfoJet_HiddenAllGroupMenu(){InfoJet_ShowSelects();if(InfoJet_IsInited()){var a=document.getElementById("xdoc_param_view_id").value;var b=document.getElementById("xdoc.contextmenu.group"+a);if(b!=null){b.style.display="none"}}return true}function InfoJet_HiddenGroupMenu(c){var a=document.getElementById("xdoc_param_view_id").value;for(var e=0;true;e++){var g=c+e;var f=g+".menu"+a;var b=document.getElementById(f);if(b!=null){b.style.backgroundColor="#FFFFFF";b.style.borderColor="#FFFFFF";var d=g+".group"+a;if(document.getElementById(d)!=null){document.getElementById(d).style.display="none";InfoJet_HiddenGroupMenu(g+".")}}else{break}}}function InfoJet_MenuOver(b,a){a.style.backgroundColor="#C1D2EE";a.style.borderColor="#316AC5"}function InfoJet_MenuOut(b,a){a.style.backgroundColor="#FFFFFF";a.style.borderColor="#FFFFFF"}function InfoJet_HiddenSiblingSubMenu(b){var a=document.getElementById("xdoc_param_view_id").value;var d=b.id.split(".");var f="";for(var c=0;c<d.length-2;c++){f+=d[c]+"."}var e="";for(var c=0;true;c++){e=f+c+".menu"+a;if(document.getElementById(e)==null){break}else{if(e!=b.id){InfoJet_HiddenSubMenuById(e)}}}}function InfoJet_HiddenSubMenuById(e){var a=document.getElementById("xdoc_param_view_id").value;var f=e.substr(0,e.length-4-a.length);var b=f+"group"+a;if(document.getElementById(b)!=null){document.getElementById(b).style.display="none";for(var c=0;true;c++){var d=f+c+".menu"+a;if(document.getElementById(d)!=null){InfoJet_HiddenSubMenuById(d)}else{break}}}}function InfoJet_ShowSubMenuById(e){var a=document.getElementById("xdoc_param_view_id").value;var c=document.getElementById(e);var d=e.substr(0,e.length-4-a.length)+"group"+a;var b=document.getElementById(d);if(b!=null){var f=InfoJet_GetPos(c);if(f==null){return}b.style.display="block";if(InfoJet_IsIE()){b.style.left=f.left+c.offsetWidth;b.style.top=f.top-2}else{b.style.left=f.left+c.offsetWidth+4;b.style.top=f.top}}}function InfoJet_ResetSwitchViewMenuCheck(){var a=document.getElementById("xdoc_param_view_id").value;for(var d=0;true;d++){var g=d+".menu"+a;var f=document.getElementById(g);if(f!=null){var c=f.getAttribute("component");if(c!=null&&c.length>0){var e=d+".check"+a;var b=document.getElementById(e);if(c==a){b.innerHTML="<div align='center'><img src='"+InfoJet_WebContext+"images/infojet_menu_check.gif'></img></div>"}else{b.innerHTML=""}}}else{break}}}function InfoJet_CheckErrorFormatting(c){InfoJet_NoErrorFormatting=!InfoJet_NoErrorFormatting;var b=c.id.replace("menu","check");var a=document.getElementById(b);if(a!=null){if(InfoJet_NoErrorFormatting){a.innerHTML="<div align='center'><img src='"+InfoJet_WebContext+"images/infojet_menu_check.gif'></img></div>";InfoJet_HideAllErrors()}else{a.innerHTML="";InfoJet_ShowAllErrors()}}}function InfoJet_IsFocusableControl(b){try{if(b.style.display=="none"||b.disabled||b.readOnly){return false}}catch(c){}if(b.tagName!=null){var a=b.tagName.toLowerCase();if(a=="input"&&b.getAttribute("type")!="hidden"){return true}if(a=="select"||a=="textarea"||a=="a"||a=="button"){return true}if(a=="span"){try{return b.isContentEditable}catch(c){return true}}}return false}function InfoJet_IsReadyForFocus(a){if(a.disabled||a.readOnly){return false}else{return true}}function InfoJet_FindFocusableControlInElement(c){try{if(c.style.display=="none"){return null}}catch(f){}if(InfoJet_IsFocusableControl(c)){if(InfoJet_IsReadyForFocus(c)){return c}}for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];if(InfoJet_IsFocusableControl(a)){if(InfoJet_IsReadyForFocus(a)){return a}}var d=InfoJet_FindFocusableControlInElement(a);if(d!=null){return d}}return null}function InfoJet_FindNextFocusableControl(e){var c=InfoJet_GetParent(e);var f=e;var a=0;while(c!=null&&c.id!="xdoc_view"){if(a>2){break}var b=InfoJet_GetNextElement(f);while(b!=null){var d=InfoJet_FindFocusableControlInElement(b);if(d!=null){return d}b=InfoJet_GetNextElement(b)}if(c.id!=null&&c.id.indexOf("_0_")==0){a++}f=c;c=InfoJet_GetParent(c)}return null}function InfoJet_OnButtonMouseDown(a,b){b.setAttribute("isMouseDown","true")}function InfoJet_RecordOldValueState(i){if(InfoJet_OldValueState==null){InfoJet_OldValueState={controlId:null,textValue:null,boolValue:false,selectedIndex:-1,fieldId:null,fieldValue:null,valid:false,hasField:false}}InfoJet_OldValueState.valid=false;InfoJet_OldValueState.controlId=i.id;var d=null;try{d=i.tagName.toLowerCase()}catch(h){return}if(d=="select"){InfoJet_OldValueState.selectedIndex=i.selectedIndex;if(InfoJet_IsComboBoxControl(i)){var c=InfoJet_GetPreviousElement(i);InfoJet_OldValueState.textValue=c.value}}else{if(d=="input"){var g=i.type.toLowerCase();if(g=="text"||g=="password"){InfoJet_OldValueState.textValue=i.value;if(InfoJet_IsComboBoxControl(i)){var a=InfoJet_GetNextElement(i);InfoJet_OldValueState.selectedIndex=a.selectedIndex}}else{if(g=="checkbox"){var b=InfoJet_GetParent(i);if(b.className=="xdMultiSelectListItem"){if(i.id.length<=0){i.id="MCheckBox"+(new Date()).getTime();InfoJet_OldValueState.controlId=i.id}}}else{if(g=="radio"){}else{InfoJet_OldValueState.controlId=null}}}}else{if(d=="textarea"){InfoJet_OldValueState.textValue=i.value}else{if(InfoJet_IsRichTextBox(i)){InfoJet_OldValueState.textValue="to be filled later"}else{InfoJet_OldValueState.controlId=null}}}}if(InfoJet_OldValueState.controlId!=null){InfoJet_OldValueState.fieldId="xdoc"+InfoJet_GetElementId(i);var f=document.getElementById(InfoJet_OldValueState.fieldId);if(f==null){InfoJet_OldValueState.fieldValue=null;InfoJet_OldValueState.hasField=false}else{InfoJet_OldValueState.fieldValue=f.value;InfoJet_OldValueState.hasField=true}}}function InfoJet_CheckOldValueState(a){if(InfoJet_OldValueState!=null){if(InfoJet_OldValueState.controlId!=null&&InfoJet_OldValueState.controlId==a.id){InfoJet_OldValueState.valid=true}else{InfoJet_OldValueState.valid=false}}}function InfoJet_UndoOldValueState(){if(InfoJet_OldValueState!=null&&InfoJet_OldValueState.valid){if(!InfoJet_OldValueState.hasField){var b=document.getElementById(InfoJet_OldValueState.fieldId);if(b!=null){InfoJet_RemoveHtmlElement(b)}}else{if(InfoJet_OldValueState.fieldId!=null){var b=document.getElementById(InfoJet_OldValueState.fieldId);b.value=InfoJet_OldValueState.fieldValue}}var f=document.getElementById(InfoJet_OldValueState.controlId);var c=f.tagName.toLowerCase();if(c=="select"){f.selectedIndex=InfoJet_OldValueState.selectedIndex;if(InfoJet_IsComboBoxControl(f)){var d=InfoJet_GetPreviousElement(f);d.value=InfoJet_OldValueState.textValue}}else{if(c=="input"){var j=f.type.toLowerCase();if(j=="text"||j=="password"){f.value=InfoJet_OldValueState.textValue;if(InfoJet_IsComboBoxControl(f)){var k=InfoJet_GetNextElement(f);k.selectedIndex=InfoJet_OldValueState.selectedIndex}}else{if(j=="checkbox"){var m=InfoJet_GetParent(f);if(m.className=="xdMultiSelectListItem"){f.checked=InfoJet_OldValueState.boolValue;var n=document.getElementById("xdoc_param_multi_select_list_item_value");if(n!=null){InfoJet_RemoveHtmlElement(n)}}else{var l=f.getAttribute(InfoJet_XdPrefix+"value");if(l!=null){var g=f.getAttribute(InfoJet_XdPrefix+"onValue");if(l==g){f.checked=true}else{f.checked=false}}}}else{if(j=="radio"){var l=f.getAttribute(InfoJet_XdPrefix+"value");if(l!=null){var h=document.getElementsByName(f.name);for(var e=0;e<h.length;e++){var a=h[e];var g=a.getAttribute(InfoJet_XdPrefix+"onValue");if(l==g){a.checked=true}else{a.checked=false}}}}}}}else{if(c=="textarea"){f.value=InfoJet_OldValueState.textValue}else{if(InfoJet_IsRichTextBox(f)){f.innerHTML=InfoJet_OldValueState.textValue}}}}InfoJet_OldValueState.valid=false;f.focus()}}function InfoJet_OnButtonFocus(b,c){InfoJet_FocusControlId=c.id;var a=c.getAttribute("isMouseDown");if(a!=null&&a=="true"){c.setAttribute("isMouseDown","false");if(InfoJet_Postbacking){InfoJet_CachedPostbackButtonId=c.id;InfoJet_RemoveFocus()}}else{if(InfoJet_OldValueState!=null){InfoJet_OldValueState.valid=false;InfoJet_OldValueState.controlId=null}}}function InfoJet_OnPictureButtonMouseOver(c){var b=InfoJet_GetFirstChild(c);if(b!=null){var d=b.getAttribute(InfoJet_XdPrefix+"HoverSRC");if(d!=null&&d.length>0){var a=b.getAttribute("oldSrc");if(a==null||a.length<=0){b.setAttribute("oldSrc",b.src);b.src=d}}}}function InfoJet_OnPictureButtonMouseOut(c){var b=InfoJet_GetFirstChild(c);if(b!=null){var d=b.getAttribute(InfoJet_XdPrefix+"HoverSRC");if(d!=null&&d.length>0){var a=b.getAttribute("oldSrc");if(a!=null||a.length>0){b.src=a;b.removeAttribute("oldSrc")}}}}function InfoJet_CheckCachedPostback(b){if(InfoJet_CachedPostbackButtonId!=null){if(b){if(!InfoJet_HideTryAgainNotification){alert(InfoJet_LocalResources.ClickAgainMessage)}}else{var a=document.getElementById(InfoJet_CachedPostbackButtonId);InfoJet_CachedPostbackButtonId=null;if(a!=null){if(!(a.style.display=="none"||a.disabled)){window.setTimeout(function(){a.onclick()},0)}}}}}function InfoJet_ClearCachedPostback(){InfoJet_CachedPostbackButtonId=null}function InfoJet_OnFocus(b,a,f,g){if((!InfoJet_IsInited())&&(a.id=="")){return}b=InfoJet_GetEvent(b);if(InfoJet_IsFocusableControl(a)){InfoJet_FocusControlId=a.id}if(InfoJet_Postbacking){InfoJet_RemoveFocus();return}InfoJet_RecordOldValueState(a);if(!g){if(InfoJet_IsSingleLineTextControl(a)){var j=a.getAttribute("noTextSelection");if(j==null){try{a.select()}catch(i){}}else{a.removeAttribute("noTextSelection")}}if(a.tagName.toLowerCase()=="textarea"){if(InfoJet_IsIE()){var e=a.createTextRange();e.collapse(true);e.select()}else{a.setSelectionRange(0,0)}}}if(f=="control"&&InfoJet_NeedFieldBorder(a)){InfoJet_ShowFieldBorder(a,"xdoc_field_focus");InfoJet_SelectTextControlPlaceHolder(a)}if(!InfoJet_NeedSectionBorder(a)){var h=InfoJet_GetParent(a);if(h!=null){InfoJet_OnFocus(b,h,f)}return}var c=InfoJet_RefreshXmlToEditItem(a,true);if(c!=null){InfoJet_ItemElement=c;InfoJet_ShowFocusMenuArrow(c);InfoJet_ShowSectionBorder(c,"xdoc_item_focus");b.cancelBubble=true}else{var d=a.getAttribute(InfoJet_XdPrefix+"xctname");if(d!=null&&d=="RichText"){InfoJet_HideFocusMenuArrow(true)}else{InfoJet_HideFocusMenuArrow(false)}}InfoJet_OnMasterDetial(b,a)}function InfoJet_UpdateMasterDetial(f,e){var g=document.getElementById("xdoc_param_master_detial").value;var b=g.split(";");for(var c=0;c<b.length;c++){var d=b[c];if(d.length>0){var h=d.split(",");var a=h[0];var j=h[1];if(a==f){if(j!=e){g=g.replace(f+","+j,f+","+e);document.getElementById("xdoc_param_master_detial").value=g;return true}}}}return false}function InfoJet_GetMasterDetial(g){var b={tbody:null,tr:null};var f=null;var e=InfoJet_XdPrefix+"masterName";var d=g;while(d!=null){if(d.tagName){var c=d.tagName.toLowerCase();if(c=="body"||c=="html"){return null}if(c=="tr"){f=d}if(c!="table"){var a=d.getAttribute(e);if(a!=null&&a.length>0){b.tbody=d;b.tr=f;return b}}d=InfoJet_GetParent(d)}else{return null}}}function InfoJet_GetCurrentDetialRow(b){var a=b.tbody;var e=b.tr;for(var d=0;d<a.childNodes.length;d++){var c=a.childNodes[d];if(c.nodeType==1){if(c==e){return d+1}}}return 1}function InfoJet_IsRichTextBox(b){try{if(b.tagName.toLowerCase()=="span"){var a=b.getAttribute(InfoJet_XdPrefix+"xctname");if(a!=null&&a=="RichText"){return true}}}catch(c){return false}}function InfoJet_OnRichTextBlur(b){if(InfoJet_IsRichTextBox(b)){var a=b.getAttribute("isEditing");if(a=="true"){InfoJet_OnNicEditBlur(b)}}}function InfoJet_OnBlur(b,c,a){InfoJet_OnRichTextBlur(c);b=InfoJet_GetEvent(b);if(!InfoJet_ShouldContinueBlur()){return}if(InfoJet_BrowserQuick){if(InfoJet_IsMultipleLineTextArea(c)){InfoJet_RelayoutFieldStyles()}}else{if(a=="control"){InfoJet_HideBorder("xdoc_field_focus")}}InfoJet_HideFocusMenuArrow();InfoJet_HideBorder("xdoc_item_focus");InfoJet_HiddenAllGroupMenu()}function InfoJet_OnMouseOver(c,d,b){if(InfoJet_BrowserQuick){return}if((!InfoJet_IsInited())&&(d.id=="")){return}c=InfoJet_GetEvent(c);if(b=="control"&&InfoJet_NeedFieldBorder(d)){InfoJet_ShowFieldBorder(d,"xdoc_field_over")}if(!InfoJet_NeedSectionBorder(d)){return}var a=InfoJet_RefreshXmlToEditItem(d,false);if(a!=null){InfoJet_ShowSectionBorder(a,"xdoc_item_over");c.cancelBubble=true}}function InfoJet_OnMouseOut(a,b){if(InfoJet_BrowserQuick){return}InfoJet_HideOverBorderArrow()}function InfoJet_BuildHorizonBorder(e,f,d,c,a){var b="";b+="<img id='"+e+"' style='";b+="z-index: "+f+"; ";b+="border-top-width: "+d+"; ";b+="border-top-style: "+c+"; ";b+="border-top-color: "+a+"; ";b+="border-right-style: none; ";b+="border-bottom-style: none; ";b+="border-left-style: none; ";b+="width: 0; height: 0; left: 100; top: 100; position: absolute;";b+="'>";return b}function InfoJet_BuildVerticalBorder(e,f,d,c,a){var b="";b+="<img id='"+e+"' style='";b+="z-index: "+f+"; ";b+="border-left-width: "+d+"; ";b+="border-left-style: "+c+"; ";b+="border-left-color: "+a+"; ";b+="border-top-style: none; ";b+="border-right-style: none; ";b+="border-bottom-style: none; ";b+="width: 0; height: 0; left: 100; top: 100; position: absolute;";b+="'>";return b}function InfoJet_BuildInvalidateBorder(b){var a=InfoJet_BuildHorizonBorder(b.id+"_top",90,"2px","dashed","#FF0000");a+=InfoJet_BuildHorizonBorder(b.id+"_bottom",90,"2px","dashed","#FF0000");a+=InfoJet_BuildVerticalBorder(b.id+"_left",90,"2px","dashed","#FF0000");a+=InfoJet_BuildVerticalBorder(b.id+"_right",90,"2px","dashed","#FF0000");return a}function InfoJet_BuildNotBlankMark(b){if(InfoJet_EnableUnderline){var c=InfoJet_BuildHorizonBorder(b.id+"_notBlank",90,"1pt","solid","#FF0000");return c}else{var a="";a+="<img id='"+b.id+"_notBlank' style='";a+="z-index: 90; display:none; position: absolute;' ";a+="src='"+InfoJet_WebContext+"images/infojet_red_star.gif'";a+=">";return a}}function InfoJet_BuildFocusOverBorder(){var b=InfoJet_BuildHorizonBorder("xdoc_item_focus_top",96,"1","dashed","#0033FF");b+=InfoJet_BuildHorizonBorder("xdoc_item_focus_bottom",96,"1","dashed","#0033FF");b+=InfoJet_BuildVerticalBorder("xdoc_item_focus_left",96,"1","dashed","#0033FF");b+=InfoJet_BuildVerticalBorder("xdoc_item_focus_right",96,"1","dashed","#0033FF");b+=InfoJet_BuildHorizonBorder("xdoc_item_over_top",97,"1","dashed","#716F64");b+=InfoJet_BuildHorizonBorder("xdoc_item_over_bottom",97,"1","dashed","#716F64");b+=InfoJet_BuildVerticalBorder("xdoc_item_over_left",97,"1","dashed","#716F64");b+=InfoJet_BuildVerticalBorder("xdoc_item_over_right",97,"1","dashed","#716F64");b+=InfoJet_BuildHorizonBorder("xdoc_field_focus_top",96,"1","solid","#0033FF");b+=InfoJet_BuildHorizonBorder("xdoc_field_focus_bottom",96,"1","solid","#0033FF");b+=InfoJet_BuildVerticalBorder("xdoc_field_focus_left",96,"1","solid","#0033FF");b+=InfoJet_BuildVerticalBorder("xdoc_field_focus_right",96,"1","solid","#0033FF");b+=InfoJet_BuildHorizonBorder("xdoc_field_over_top",97,"1","solid","#716F64");b+=InfoJet_BuildHorizonBorder("xdoc_field_over_bottom",97,"1","solid","#716F64");b+=InfoJet_BuildVerticalBorder("xdoc_field_over_left",97,"1","solid","#716F64");b+=InfoJet_BuildVerticalBorder("xdoc_field_over_right",97,"1","solid","#716F64");var a=document.getElementById("xdoc_focusover");a.innerHTML=b;InfoJet_ItemOverTop=document.getElementById("xdoc_item_over_top");InfoJet_ItemOverBottom=document.getElementById("xdoc_item_over_bottom");InfoJet_ItemOverLeft=document.getElementById("xdoc_item_over_left");InfoJet_ItemOverRight=document.getElementById("xdoc_item_over_right");InfoJet_FieldOverTop=document.getElementById("xdoc_field_over_top");InfoJet_FieldOverBottom=document.getElementById("xdoc_field_over_bottom");InfoJet_FieldOverLeft=document.getElementById("xdoc_field_over_left");InfoJet_FieldOverRight=document.getElementById("xdoc_field_over_right");InfoJet_ItemFocusTop=document.getElementById("xdoc_item_focus_top");InfoJet_ItemFocusBottom=document.getElementById("xdoc_item_focus_bottom");InfoJet_ItemFocusLeft=document.getElementById("xdoc_item_focus_left");InfoJet_ItemFocusRight=document.getElementById("xdoc_item_focus_right");InfoJet_FieldFocusTop=document.getElementById("xdoc_field_focus_top");InfoJet_FieldFocusBottom=document.getElementById("xdoc_field_focus_bottom");InfoJet_FieldFocusLeft=document.getElementById("xdoc_field_focus_left");InfoJet_FieldFocusRight=document.getElementById("xdoc_field_focus_right")}function InfoJet_ShowFieldBorder(b,d){if(InfoJet_BrowserQuick){return}var g=InfoJet_GetPos(b);if(g==null){return}var e=document.getElementById(d+"_left");if(e==null){return}e.style.left=g.left;e.style.top=g.top;e.style.height=b.offsetHeight;var a=document.getElementById(d+"_right");a.style.left=g.left+b.offsetWidth-1;a.style.top=g.top;a.style.height=b.offsetHeight;var f=document.getElementById(d+"_top");f.style.left=g.left;f.style.top=g.top;f.style.width=b.offsetWidth;var c=document.getElementById(d+"_bottom");c.style.left=g.left;c.style.top=g.top+b.offsetHeight-1;c.style.width=b.offsetWidth}function InfoJet_ShowInvalidateBorder(j){var i=j.id;var k=document.getElementById(i+"_left");if(k==null){var f=InfoJet_BuildInvalidateBorder(j);var h=document.getElementById("xdoc_fieldstyle");InfoJet_InsertAdjacentHTMLBeforeEnd(h,f);k=document.getElementById(i+"_left")}var m=InfoJet_GetPos(j);if(m==null){return}var g=InfoJet_IsSelect(j);var b=0;if(g){m.left=m.left-2;m.top=m.top-2;b=4}var q=InfoJet_GetStylePixelSize(j,"borderLeftWidth","border-left-width");var o=InfoJet_GetStylePixelSize(j,"borderTopWidth","border-top-width");var a=InfoJet_GetStylePixelSize(j,"borderRightWidth","border-right-width");var d=InfoJet_GetStylePixelSize(j,"borderBottomWidth","border-bottom-width");var p=0;k.style.left=m.left+q-2;k.style.top=m.top+o-2;p=j.offsetHeight-o-d+2+b;if(p>=0){k.style.height=p}var n=document.getElementById(i+"_right");n.style.left=m.left+j.offsetWidth-a+b;n.style.top=m.top+o-2;p=j.offsetHeight-o-d+2+b;if(p>=0){n.style.height=p}var c=0;var e=document.getElementById(i+"_top");e.style.left=m.left+q-2;e.style.top=m.top+o-2;c=j.offsetWidth-q-a+2+b;if(c>=0){e.style.width=c}var l=document.getElementById(i+"_bottom");l.style.left=m.left+q-2;l.style.top=m.top+j.offsetHeight-d+b;c=j.offsetWidth-q-a+2+b;if(c>=0){l.style.width=c}}function InfoJet_ShowNotBlankMark(g){var f=document.getElementById(g.id+"_notBlank");if(f==null){var a=InfoJet_BuildNotBlankMark(g);var d=document.getElementById("xdoc_fieldstyle");InfoJet_InsertAdjacentHTMLBeforeEnd(d,a);f=document.getElementById(g.id+"_notBlank")}if(g.tagName){var b=g.tagName.toLowerCase();var h=InfoJet_GetPos(g);if(h==null){return}if(b=="div"||b=="span"){f.style.left=h.left+g.offsetWidth-12;f.style.top=h.top+(g.offsetHeight-8)/2;f.style.display="block";return}else{if(b=="a"||b=="img"){f.style.left=h.left+g.offsetWidth-10;f.style.top=h.top+2;f.style.display="block";return}}}var e=false;var c=g.getAttribute(InfoJet_XdPrefix+"ghosted");if(c!=null&&c=="true"){e=true}if(g.value.length<=0||e){var h=InfoJet_GetPos(g);if(h==null){return}if(InfoJet_EnableUnderline){f.style.left=h.left;f.style.top=h.top+g.offsetHeight;f.style.width=g.offsetWidth}else{var b=g.tagName.toLowerCase();if(b=="select"){if(InfoJet_IsIE7()){f.style.left=h.left+g.offsetWidth-29;f.style.top=h.top+4}else{f.style.left=h.left+g.offsetWidth+2;f.style.top=h.top+4}}else{if(InfoJet_RedAsteriskOTA){if(g.style.textAlign=="right"){f.style.left=h.left+4;f.style.top=h.top+(g.offsetHeight-8)/2}else{f.style.left=h.left+g.offsetWidth-12;f.style.top=h.top+(g.offsetHeight-8)/2}}else{f.style.left=h.left+g.offsetWidth-12;f.style.top=h.top+(g.offsetHeight-8)/2}}}f.style.display="block"}else{f.style.display="none"}}function InfoJet_ShowSectionBorder(e,d){var h=InfoJet_GetPos(e);if(h==null){return}var k=InfoJet_GetStylePixelSize(e,"borderLeftWidth","border-left-width");var j=InfoJet_GetStylePixelSize(e,"borderTopWidth","border-top-width");var a=InfoJet_GetStylePixelSize(e,"borderRightWidth","border-right-width");var b=InfoJet_GetStylePixelSize(e,"borderBottomWidth","border-bottom-width");var f=document.getElementById(d+"_left");f.style.left=h.left+k-1;f.style.top=h.top+j-1;f.style.height=e.offsetHeight-j-b;var i=document.getElementById(d+"_right");i.style.left=h.left+e.offsetWidth-a;i.style.top=h.top+j;i.style.height=e.offsetHeight-j-b;var c=document.getElementById(d+"_top");c.style.left=h.left+k-1;c.style.top=h.top+j-1;c.style.width=e.offsetWidth-k-a;var g=document.getElementById(d+"_bottom");g.style.left=h.left+k;g.style.top=h.top+e.offsetHeight-b;g.style.width=e.offsetWidth-k-a}function InfoJet_ShowFocusMenuArrow(d){if(!InfoJet_ShowMenuArrow){return}var a=document.getElementById("xdoc_menu_focus_arrow_img");var b=d.getAttribute(InfoJet_XdPrefix+"xctname");if(b=="Section"){a.src=InfoJet_WebContext+"images/infojet_menu_xoptional_focus_arrow.gif"}else{if(b=="choiceterm"||b=="choicetermrepeating"){a.src=InfoJet_WebContext+"images/infojet_menu_xreplace_focus_arrow.gif"}else{a.src=InfoJet_WebContext+"images/infojet_menu_xcollection_focus_arrow.gif"}}var e=InfoJet_GetPos(d);if(e==null){return}var c=document.getElementById("xdoc_menu_focus_arrow");c.style.left=e.left-18+2;c.style.top=e.top+2;c.style.display="block"}function InfoJet_ShowOverMenuArrow(c){if(!InfoJet_ShowMenuArrow){return}var a=document.getElementById("xdoc_menu_over_arrow_img");var b=c.getAttribute(InfoJet_XdPrefix+"xctname");if(b=="Section"){a.src=InfoJet_WebContext+"images/infojet_menu_xoptional_over_arrow.gif"}else{if(b=="choiceterm"||b=="choicetermrepeating"){a.src=InfoJet_WebContext+"images/infojet_menu_xreplace_over_arrow.gif"}else{a.src=InfoJet_WebContext+"images/infojet_menu_xcollection_over_arrow.gif"}}var e=InfoJet_GetPos(c);if(e==null){return}var d=document.getElementById("xdoc_menu_over_arrow");d.style.left=e.left-18+2;d.style.top=e.top+2;d.style.display="block"}function InfoJet_HideOverMenuArrow(){var a=document.getElementById("xdoc_menu_over_arrow");if(a!=null){a.style.display="none"}}function InfoJet_HideBorder(a){InfoJet_HideDashedBorder(a);InfoJet_HideNotBlankMark(a)}function InfoJet_HideDashedBorder(c){var d=document.getElementById(c+"_left");if(d==null){return}d.style.height=0;var a=document.getElementById(c+"_right");a.style.height=0;var e=document.getElementById(c+"_top");e.style.width=0;var b=document.getElementById(c+"_bottom");b.style.width=0}function InfoJet_HideNotBlankMark(b){var a=document.getElementById(b+"_notBlank");if(a!=null){a.style.display="none"}}function InfoJet_HideFocusMenuArrow(a){var b=document.getElementById("xdoc_menu_focus_arrow");if(b){b.style.display="none"}if(!InfoJet_EditRichTextOnFocus){if(!a){var c=document.getElementById("xdoc_menu_rtb_edit");if(c){c.style.display="none"}}}}function InfoJet_HideAllErrors(){if(InfoJet_NoValidation){return}var d=document.getElementById("xdoc_data_error");if(d==null){return}for(var c=0;c<d.childNodes.length;c++){var b=d.childNodes[c];if(b.nodeType==1){var a=b.getAttribute("JetId");InfoJet_HideError(a)}}}function InfoJet_HideError(e){var a=InfoJet_GetPureId(e);var b=a;for(var d=0;true;d++){if(d!=0){b=a+","+d}var c=document.getElementById(b);if(c==null){break}else{InfoJet_HideNecessaryInvalidateBorder(c);InfoJet_ResetTitle(c)}}}function InfoJet_ShowSchemaError(e){var a=InfoJet_GetPureId(e);for(var d=0;true;d++){var b=a;if(d!=0){b=a+","+d}var c=document.getElementById(b);if(c==null){break}else{InfoJet_ShowNecessaryInvalidateBorder(c)}}}function InfoJet_ShowAllErrors(){if(InfoJet_NoValidation){return}var a=document.getElementById("xdoc_data_error");if(a==null){return}for(var g=0;g<a.childNodes.length;g++){var k=a.childNodes[g];if(k.nodeType==1){var c=k.getAttribute("JetId");var j=k.getAttribute("type");var m=InfoJet_GetPureId(c);if(j=="schema"){for(var e=0;true;e++){var h=m;if(e!=0){h=m+","+e}if(h.length<=0){continue}var l=document.getElementById(h);if(l==null){break}else{InfoJet_ShowNecessaryInvalidateBorder(l)}}}else{if(j=="condition"){for(var e=0;true;e++){var h=m;if(e!=0){h=m+","+e}if(h.length<=0){continue}var l=document.getElementById(h);if(l==null){break}else{var d=l.getAttribute("isPicker");if(d&&d=="true"){var f=InfoJet_GetFirstChild(l);var b=InfoJet_GetFirstChild(f);InfoJet_ShowNotBlankMark(b);InfoJet_ShowTitle(l,k.innerHTML)}else{InfoJet_ShowNecessaryInvalidateBorder(l);InfoJet_ShowTitle(l,k.innerHTML)}}}}else{if(j=="program"){for(var e=0;true;e++){var h=m;if(e!=0){h=m+","+e}if(h.length<=0){continue}var l=document.getElementById(h);if(l==null){break}else{InfoJet_ShowNecessaryInvalidateBorder(l);InfoJet_ShowTitle(l,k.innerHTML)}}}}}}}}function InfoJet_AddSchemaError(h){var f=document.getElementById("xdoc_data_error");if(f==null){return}var e=false;for(var c=0;c<f.childNodes.length;c++){var b=f.childNodes[c];if(b.nodeType==1){var a=b.getAttribute("JetId");var d=b.getAttribute("type");if(h==a&&d=="schema"){e=true;break}}}if(!e){var g="<div JetId='"+h+"' type='schema' style='display:none'></div>";InfoJet_InsertAdjacentHTMLBeforeEnd(f,g)}}function InfoJet_RemoveError(b,c){var e=InfoJet_GetPureId(b);var a=document.getElementById("xdoc_data_error");if(a==null){return}var j=new Array();for(var d=0;d<a.childNodes.length;d++){var g=a.childNodes[d];if(g.nodeType==1){var h=g.getAttribute("JetId");var f=g.getAttribute("type");if(InfoJet_PureIdEquals(e,h)&&f==c){j.push(g)}}}for(var d=0;d<j.length;d++){var g=j[d];InfoJet_RemoveHtmlElement(g)}}function InfoJet_RemoveErrors(e){var d=document.getElementById("xdoc_data_error");if(d==null){return}var f=new Array();for(var b=0;b<d.childNodes.length;b++){var a=d.childNodes[b];if(a.nodeType==1){var c=a.getAttribute("type");if(c==e){f.push(a)}}}for(var b=0;b<f.length;b++){var a=f[b];InfoJet_RemoveHtmlElement(a)}}function InfoJet_AddError(e,b,a){var c=document.getElementById("xdoc_data_error");if(c==null){return}var d="<div JetId='"+e+"' type='"+a+"' style='display:none'>"+b+"</div>";InfoJet_InsertAdjacentHTMLBeforeEnd(c,d)}function InfoJet_ShowTitle(b,c){var a=b.getAttribute("title_bak");if(a!=null){if(a.length>0){b.title=c+"\n"+a}else{b.title=c}}else{b.setAttribute("title_bak",b.title);if(b.title.length>0){b.title=c+"\n"+b.title}else{b.title=c}}}function InfoJet_ResetTitle(b){var a=b.getAttribute("title_bak");if(a!=null){b.title=a;b.removeAttribute("title_bak")}}function InfoJet_HideNecessaryInvalidateBorder(a){if(InfoJet_NoValidation){return}InfoJet_HideBorder(a.id)}function InfoJet_ShowNecessaryInvalidateBorder(g){if(InfoJet_NoValidation){return}if(g.disabled){return}var j=null;if(g.className!=null&&g.className.indexOf("ComboBoxTextField")>0){var e=InfoJet_GetParent(g).getAttribute(InfoJet_XdPrefix+"xctname");if(e!=null&&e.toLowerCase()=="combobox"){return}}var b=g.tagName.toLowerCase();if(b=="a"){InfoJet_ShowNotBlankMark(g);return}else{if(b=="img"){InfoJet_ShowNotBlankMark(g);return}}if(b=="span"){if(InfoJet_GetText(g).length<=0){InfoJet_HideDashedBorder(g.id);InfoJet_ShowNotBlankMark(g)}else{InfoJet_HideNotBlankMark(g.id);InfoJet_ShowInvalidateBorder(g)}}if(b=="input"||b=="textarea"||b=="select"){var m=g.getAttribute(InfoJet_XdPrefix+"ghosted");if(m!=null&&m=="true"){InfoJet_HideDashedBorder(g.id);InfoJet_ShowNotBlankMark(g)}else{var h=g.value;if(b=="select"&&g.className!=null&&g.className.indexOf("xdComboBox")>=0){var e=InfoJet_GetParent(g).getAttribute(InfoJet_XdPrefix+"xctname");if(e!=null&&e.toLowerCase()=="combobox"){var k=null;var c=InfoJet_GetPreviousElement(g);var d=c.value;for(var f=0;f<g.options.length;f++){var l=g.options[f].text;if(l!=null&&d==l){k=g.options[f].value;break}}if(k!=null){h=k}else{h=d;g.value=d}}}var a=g.getAttribute("type");if(a!=null){a=a.toLowerCase()}if(a&&(a=="radio"||a=="checkbox")){InfoJet_HideNotBlankMark(g.id);InfoJet_ShowInvalidateBorder(g)}else{if(h!=null&&h.length>0){InfoJet_HideNotBlankMark(g.id);InfoJet_ShowInvalidateBorder(g)}else{InfoJet_HideDashedBorder(g.id);InfoJet_ShowNotBlankMark(g)}}}}}function InfoJet_RefreshContext(c){var b="";var d=InfoJet_GetElementId(c);var a=c;while(d!="xdoc_view"){if(d.indexOf("_0_")==0){b=b+d+";"}a=InfoJet_GetParent(a);d=InfoJet_GetElementId(a)}if(b.length>0){b=b.substr(0,b.length-1)}document.getElementById("xdoc_param_context_id_array").value=b}function InfoJet_GetInnerMostContextId(b){var a=InfoJet_GetParent(b);var c=a.id;while(c!="xdoc_view"){if(c.indexOf("_0_")==0){return c}if(c.indexOf("_s_")==0){return c}a=InfoJet_GetParent(a);c=InfoJet_GetElementId(a)}return document.getElementById("xdoc_data_root_element_id").innerHTML}function InfoJet_IsFuncDefined(funcName){var stat="typeof( "+funcName+" ) != 'undefined';";return eval(stat)}function InfoJet_IsButton(c){var a=c.tagName.toLowerCase();if(a=="input"){var b=c.getAttribute("type");if(b!=null){b=b.toLowerCase();if(b=="button"){return true}}}return false}function InfoJet_OnMasterDetial(f,g){var b=document.getElementById("xdoc_param_master_detial").value;if(b.length<=0){return}var e=InfoJet_XdPrefix+"masterName";var c=InfoJet_GetMasterDetial(g);if(c!=null){if(c.tbody!=null&&c.tr!=null){var a=c.tbody.getAttribute(e);var d=InfoJet_GetCurrentDetialRow(c);InfoJet_DoMasterDetail(g,a,d)}}}function InfoJet_DoMasterDetail(c,a,b){if(InfoJet_GetParent(c)==null){return}InfoJet_MoveProgress2ControlPosition(c);if(InfoJet_UpdateMasterDetial(a,b)){document.getElementById("xdoc_param_command").value="Update_Refresh";InfoJet_Submit()}}function InfoJet_RefreshAfaterUpdate(a){if(InfoJet_NoPostback){return}InfoJet_MoveProgress2ControlPosition(a);document.getElementById("xdoc_param_update_id").value=a.id;document.getElementById("xdoc_param_update_format").value=a.getAttribute(InfoJet_XdPrefix+"datafmt");document.getElementById("xdoc_param_command").value="Update_Refresh";InfoJet_FocusControlId=a.id;InfoJet_Submit()}function InfoJet_CheckClickFrequently(b){if(InfoJet_Postbacking>0){if(!InfoJet_HideTryAgainNotification){alert(InfoJet_LocalResources.TryAgainMessage)}return true}else{if(b==null){if(!InfoJet_HideTryAgainNotification){alert(InfoJet_LocalResources.TryAgainMessage)}return true}var a=InfoJet_GetParent(b);if(a==null){if(!InfoJet_HideTryAgainNotification){alert(InfoJet_LocalResources.TryAgainMessage)}return true}return false}}function InfoJet_OnPlaceholderClick(a,k){k.setAttribute("isMouseDown","false");if(!InfoJet_IsIE()){var e=k.getAttribute("disabled");if(e!=null&&e=="true"){return}}var c=k.getAttribute(InfoJet_XdPrefix+"xmlToEdit");var f="-"+c+"-editing: disabled";var l=InfoJet_GetParent(k);while(l!=null){var b=l.style.cssText;if(b!=null&&b.indexOf(f)>0){return}l=InfoJet_GetParent(l);if(l!=null&&l.id=="xdoc_view"){break}}if(InfoJet_CheckClickFrequently(k)){return}var d=k.getAttribute(InfoJet_XdPrefix+"xmlToEdit");var h=k.getAttribute(InfoJet_XdPrefix+"action");if((!InfoJet_IsViewValid())&&InfoJet_IsIdInArray(d,"xdoc_data_valid_view_xmltoedit_list")){if(h.indexOf("::remove")<0){alert(InfoJet_LocalResources.CorrectFirstMessage);return}}InfoJet_RefreshContext(k);if(h=="xTextList::insert"){var j=InfoJet_GetPreviousElement(k);if(j!=null){var g=InfoJet_GetFirstChild(j);if(g!=null){var m=InfoJet_GetLastChild(g);if(m!=null){var i=InfoJet_GetFirstChild(m);if(i!=null){InfoJet_RefreshContext(i)}}}}}InfoJet_MoveProgress2ControlPosition(k);document.getElementById("xdoc_param_xml_to_edit_name").value=d;document.getElementById("xdoc_param_xml_to_edit_action").value=h;document.getElementById("xdoc_param_command").value="Update_XmlToEdit";InfoJet_Submit()}function InfoJet_OnPlaceholderKeydown(a,b){if(a.keyCode==13){InfoJet_OnPlaceholderClick(a,b)}}function InfoJet_DoXmlToEditAction(g,d,f){var e=document.getElementById(g);if(InfoJet_CheckClickFrequently(e)){return}InfoJet_MoveProgress2ControlPosition(e);if((!InfoJet_IsViewValid())&&InfoJet_IsIdInArray(d,"xdoc_data_valid_view_xmltoedit_list")){if(f.indexOf("::remove")<0){alert(InfoJet_LocalResources.CorrectFirstMessage);return}}var c=new Array();if(g==null){c[c.length]=document.getElementById("xdoc_data_root_element_id").innerHTML}else{InfoJet_GetMenuContextIds(c,e)}var a="";for(var b=0;b<c.length;b++){a+=c[b];if(b<c.length-1){a+=";"}}document.getElementById("xdoc_param_context_id_array").value=a;document.getElementById("xdoc_param_xml_to_edit_name").value=d;document.getElementById("xdoc_param_xml_to_edit_action").value=f;document.getElementById("xdoc_param_command").value="Update_XmlToEdit";InfoJet_Submit()}function InfoJet_DoSwitchView(a){if(InfoJet_ViewSwitchValidation){if(!InfoJet_IsViewValid()){alert(InfoJet_LocalResources.CorrectFirstMessage);return}}InfoJet_FocusControlId=null;InfoJet_MoveProgress2CentralPosition();document.getElementById("xdoc_param_view_id").value=a;document.getElementById("xdoc_param_command").value="Update_View";InfoJet_Submit()}function InfoJet_DoNew(a){InfoJet_MoveProgress2ControlPosition(a);if(confirm(InfoJet_LocalResources.DeleteAllMessage)){InfoJet_FocusControlId=a.id;document.getElementById("xdoc_param_command").value="Update_New";InfoJet_Submit()}}function InfoJet_DoQuery(a){InfoJet_MoveProgress2ControlPosition(a);InfoJet_FocusControlId=a.id;document.getElementById("xdoc_param_command").value="Update_Query";InfoJet_Submit()}function InfoJet_DoQueryDirect(){document.getElementById("xdoc_param_command").value="Update_Query";InfoJet_Submit()}function InfoJet_DoRefresh(a){InfoJet_MoveProgress2ControlPosition(a);document.getElementById("xdoc_param_command").value="Update_Refresh";var b=a.getAttribute(InfoJet_XdPrefix+"auxDom");if(b==null){b=""}InfoJet_FocusControlId=a.id;document.getElementById("xdoc_param_auxdom").value=b;InfoJet_Submit()}function InfoJet_DoSubmit(b){InfoJet_MoveProgress2ControlPosition(b);if(InfoJet_ValidSubmit&&(!InfoJet_IsValid())&&(!InfoJet_NoValidation)){alert(InfoJet_LocalResources.CorrectFirstMessage);return}if(InfoJet_IsButton(b)){var a=b.getAttribute(InfoJet_XdPrefix+"CtrlId");document.getElementById("xdoc_param_button").value=a;document.getElementById("xdoc_param_button_source").value=InfoJet_GetInnerMostContextId(b)}InfoJet_FocusControlId=b.id;document.getElementById("xdoc_param_command").value="Update_Submit";InfoJet_Submit()}function InfoJet_DoSubmitDirect(){document.getElementById("xdoc_param_command").value="Update_Submit";InfoJet_Submit()}function InfoJet_DefaultSubmit(){if(InfoJet_ValidSubmit&&(!InfoJet_IsValid())&&(!InfoJet_NoValidation)){alert(InfoJet_LocalResources.CorrectFirstMessage);return}document.getElementById("xdoc_param_command").value="Update_Submit";InfoJet_Submit()}function InfoJet_OpenExportedMHT(a){InfoJet_MoveProgress2ControlPosition(a);document.getElementById("xdoc_param_command").value="Update_Button";document.getElementById("xdoc_param_button").value="Inner_Export_Mht_Button";document.getElementById("xdoc_param_button_source").value="";InfoJet_Submit()}function InfoJet_OpenExportedHTML4FF(a){InfoJet_MoveProgress2ControlPosition(a);document.getElementById("xdoc_param_command").value="Update_Button";document.getElementById("xdoc_param_button").value="Inner_Export_Html4FF_Button";document.getElementById("xdoc_param_button_source").value="";InfoJet_Submit()}function InfoJet_OpenPrintableVersion(a){if(InfoJet_IsIE()){InfoJet_OpenExportedMHT(a)}else{InfoJet_OpenExportedHTML4FF(a)}}function InfoJet_CheckOnClickTable(f,b){var a=document.getElementById("xdoc_param_view_id").value;var d=a+"#"+b;if(InfoJet_OnClickTable!=null){for(var g in InfoJet_OnClickTable){if(g==d){var e={control:f,id:b};var c={};return InfoJet_OnClickTable[d].call(null,e,c)}}}return true}function InfoJet_DoButton(source){source.setAttribute("isMouseDown","false");if(InfoJet_CheckClickFrequently(source)){return}InfoJet_MoveProgress2ControlPosition(source);var ctrlId=source.getAttribute(InfoJet_XdPrefix+"CtrlId");if(ctrlId==null){return}if((!InfoJet_IsViewValid())&&InfoJet_IsIdInArray(ctrlId,"xdoc_data_valid_view_button_list")){alert(InfoJet_LocalResources.CorrectFirstMessage);return}if((!InfoJet_IsValid())&&InfoJet_IsFuncDefined("OnValidFormButton_"+ctrlId)){eval("OnValidFormButton_"+ctrlId+"();");return}if(!InfoJet_CheckOnClickTable(source,ctrlId)){return}if(InfoJet_IsFuncDefined("OnClientScriptButton_"+ctrlId)){if(!eval("OnClientScriptButton_"+ctrlId+"();")){return}}var isSubmitButton=source.getAttribute("submit_button");if(isSubmitButton!=null&&isSubmitButton=="true"){if(InfoJet_ValidSubmit&&(!InfoJet_IsValid())&&(!InfoJet_NoValidation)){alert(InfoJet_LocalResources.CorrectFirstMessage);return}}InfoJet_FocusControlId=source.id;document.getElementById("xdoc_param_command").value="Update_Button";document.getElementById("xdoc_param_button").value=ctrlId;document.getElementById("xdoc_param_button_source").value=InfoJet_GetInnerMostContextId(source);InfoJet_Submit()}function InfoJet_DoButtonDirect(a,b){InfoJet_MoveProgress2CentralPosition();document.getElementById("xdoc_param_command").value="Update_Button";document.getElementById("xdoc_param_button").value=a;document.getElementById("xdoc_param_button_source").value=b;InfoJet_Submit()}function InfoJet_RebuildByCommand(a){if(InfoJet_ShowProgress&&InfoJet_Progress==null){InfoJet_FuncAfterInit="InfoJet_MoveProgress2CentralPosition(); InfoJet_StartProgress();"}InfoJet_MoveProgress2CentralPosition();document.getElementById("xdoc_param_command").value="Update_Rebuild";document.getElementById("xdoc_param_rebuild_command").value=a;if(InfoJet_AjaxBracket!=null){InfoJet_UpdateAjaxBracket()}InfoJet_Submit()}function InfoJet_OnPostbackStart(){if(InfoJet_IsFuncDefined("InfoJetCustom_OnPostbackStart")){eval("InfoJetCustom_OnPostbackStart();")}}function InfoJet_OnPostbackEnd(){if(InfoJet_IsFuncDefined("InfoJetCustom_OnPostbackEnd")){eval("InfoJetCustom_OnPostbackEnd();")}}function InfoJet_Submit(d){InfoJet_NewStructureNodeId=null;InfoJet_Postbacking=1;InfoJet_StartProgress();InfoJet_OnPostbackStart();if(InfoJet_UseAjax){InfoJet_AJAXRequest(d)}else{var c=null;if(typeof(d)!="undefined"){c=d}else{c=document.getElementById("xdoc_form")}var e=document.getElementById("xdoc_param_action").value;var a=InfoJet_GetFrameDocument("xdoc_frame");if(a.forms.length>0&&a.forms[0].name!="xdoc_service"){a.forms[0].action=e;a.forms[0].innerHTML=c.innerHTML;a.forms[0].submit()}else{var b="<html><head><meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta></head>";b+="<body><form id='xdoc_service' name='xdoc_service' method='post' action='"+e+"'>";b+="</form></body></html>";a.write(b);a.forms[0].innerHTML=c.innerHTML;a.forms[0].submit()}}}function InfoJet_PostbackOnControl(a){InfoJet_CheckOldValueState(a);InfoJet_MoveProgress2ControlPosition(a);InfoJet_AJAXonField(a)}function InfoJet_AJAXonField(a){if(InfoJet_NoPostback){return}InfoJet_Postbacking=1;InfoJet_StartProgress();InfoJet_OnPostbackStart();document.getElementById("xdoc_param_update_id").value=a.id;document.getElementById("xdoc_param_update_format").value=a.getAttribute(InfoJet_XdPrefix+"datafmt");document.getElementById("xdoc_param_command").value="Update_Refresh";InfoJet_FocusControlId=a.id;InfoJet_AJAXRequest()}function InfoJet_BuildAJAXPost(c){var e=new Array();for(var b=0;b<c.childNodes.length;b++){var d=c.childNodes[b];if(d.nodeType==1){if(d.name){e.push(d.name+"="+encodeURIComponent(d.value))}}}var a=e.join("&");return a}function InfoJet_AJAXRequest(c){InfoJet_NewStructureNodeId=null;var b=null;if(typeof(c)!="undefined"){b=c}else{b=document.getElementById("xdoc_form")}var a=InfoJet_BuildAJAXPost(b);var d=document.getElementById("xdoc_param_action").value;if(InfoJet_XHR==null){InfoJet_XHR=InfoJet_AJAXCreateRequest()}InfoJet_XHR.open("POST",d,true);InfoJet_XHR.onreadystatechange=InfoJet_AJAXResponse;InfoJet_XHR.setRequestHeader("Content-Length",a.length);InfoJet_XHR.setRequestHeader("CONTENT-TYPE","application/x-www-form-urlencoded");InfoJet_XHR.send(a)}function InfoJet_AJAXResponse(){if(InfoJet_XHR.readyState==4){if(InfoJet_XHR.status==200){var responseText=InfoJet_XHR.responseText;if(InfoJet_AjaxBracket!=null&&InfoJet_AjaxBracket.length>0){var ajaxBracket="--"+InfoJet_AjaxBracket+"--";var ajaxBracketIndex=responseText.indexOf(ajaxBracket);var ajaxBracketStart=ajaxBracketIndex+ajaxBracket.length;var ajaxBracketEnd=responseText.indexOf(ajaxBracket,ajaxBracketStart);responseText=responseText.substr(ajaxBracketStart,ajaxBracketEnd-ajaxBracketStart)}try{if(responseText.indexOf("InfoJetSoft.Service.")>=0){var errorStart=responseText.indexOf("<!--InfoJetSoft.Service.PostbackError-->");if(errorStart>=0){var errorMessage=null;var messageKey="<!--InfoJetSoft.Service.ErrorMessage(";var messageStart=responseText.indexOf(messageKey);if(messageStart>=0){var messageEnd=responseText.indexOf(")-->",messageStart);messageStart=messageStart+messageKey.length;errorMessage=responseText.substr(messageStart,messageEnd-messageStart)}InfoJet_OnPostbackError(errorMessage);return}var reloginStart=responseText.indexOf("<!--InfoJetSoft.Service.Relogin-->");if(reloginStart>=0){if(typeof(InfoJetCustom_ReloginAfterAJAXPostback)!="undefined"){InfoJetCustom_ReloginAfterAJAXPostback()}else{alert("InfoJetCustom_ReloginAfterAJAXPostback() is not defined.")}return}var loginUrlKey="InfoJetSoft.Service.LoginUrl(";var loginUrlStart=responseText.indexOf(loginUrlKey);if(loginUrlStart>=0){var loginUrlEnd=responseText.indexOf(")",loginUrlStart);loginUrlStart=loginUrlStart+loginUrlKey.length;var loginUrl=responseText.substr(loginUrlStart,loginUrlEnd-loginUrlStart);if(typeof(InfoJetCustom_BeforeGotoLoginPage)!="undefined"){InfoJetCustom_BeforeGotoLoginPage()}window.location=loginUrl;return}}if(responseText.indexOf("----$InfoJet_Separator$----")>0){var fragments=responseText.split("----$InfoJet_Separator$----");var viewHtml=fragments[0];var formHtml=fragments[1];var dataHtml=fragments[2];responseText=fragments[3];InfoJet_ReloadFormVars(viewHtml,formHtml,dataHtml);eval(responseText)}else{eval(responseText)}}catch(e){var startErrorMessageIndex=responseText.indexOf("--InfoJet_Custom_Error_Message--");var endErrorMessageIndex=responseText.lastIndexOf("--InfoJet_Custom_Error_Message--");if(startErrorMessageIndex>=0&&endErrorMessageIndex>startErrorMessageIndex){startErrorMessageIndex=startErrorMessageIndex+"--InfoJet_Custom_Error_Message--".length;var errorMessage=responseText.substr(startErrorMessageIndex,endErrorMessageIndex-startErrorMessageIndex);errorMessage=errorMessage.replace(/(^\s*)|(\s*$)/g,"");alert(errorMessage)}else{if(responseText.indexOf("var ")!=0&&responseText.indexOf("InfoJet_")!=0){if(responseText.indexOf("[InfoJetService.MC01]")==0){alert("Form template is not avaliable. Please try again later or contact your system administrator.");InfoJet_StopProgress();InfoJet_Postbacking=0;InfoJet_OnPostbackEnd();InfoJet_UndoOldValueState()}else{alert(responseText)}}else{alert(e.message)}}}}else{if(InfoJet_IsFuncDefined("InfoJetCustom_OnAjaxError")){InfoJetCustom_OnAjaxError(InfoJet_XHR)}else{if(!InfoJet_CheckNetworkError()){InfoJet_OnPostbackError("Error("+InfoJet_XHR.status+") occurred.")}}}}}var InfoJet_NetworkErrorCodes=[0,1223,12002,12029,12030,12031,12152];function InfoJet_CheckNetworkError(){for(var a=0;a<InfoJet_NetworkErrorCodes.length;a++){if(InfoJet_XHR.status==InfoJet_NetworkErrorCodes[a]){var b="";if(InfoJet_OldValueState!=null&&InfoJet_OldValueState.valid){b="Undoing entry due to Network Error("+InfoJet_XHR.status+"), please check your network connection."}else{b="Network Error("+InfoJet_XHR.status+") occurred, please check your network connection"}alert(b);InfoJet_StopProgress();InfoJet_Postbacking=0;InfoJet_OnPostbackEnd();InfoJet_UndoOldValueState();return true}}return false}function InfoJet_OnPostbackError(a){if(InfoJet_Postbacking>0){if(InfoJet_IsFuncDefined("InfoJetCustom_OnPostbackError")){InfoJetCustom_OnPostbackError(a)}else{alert(a)}}}function InfoJet_AJAXCreateRequest(){var c=null;if(document.all){try{c=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{c=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){c=null}}}else{c=new XMLHttpRequest()}if(c==null){alert("Failed: Cannot create XMLHttpRequest.")}return c}function InfoJet_UpdateAjaxBracket(){var a=document.getElementById("xdoc_param_ajax_bracket");if(a!=null){a.value=InfoJet_AjaxBracket}}function InfoJet_OnCanvasContextMenu(a){return false}function InfoJet_Ping(){if(InfoJet_PingParameter!=null){var b=document.getElementById("xdoc_param_action").value;if(InfoJet_PingXHR==null){InfoJet_PingXHR=InfoJet_AJAXCreateRequest()}var a=InfoJet_PingParameter;InfoJet_PingXHR.open("POST",b,true);InfoJet_PingXHR.setRequestHeader("Content-Length",a.length);InfoJet_PingXHR.setRequestHeader("CONTENT-TYPE","application/x-www-form-urlencoded");InfoJet_PingXHR.send(a);window.setTimeout("InfoJet_Ping();",InfoJet_PingInterval)}}function InfoJet_BuildProgress(){if(InfoJet_ShowProgress&&InfoJet_Progress==null){var c="<div id='xdoc_progress' style='visibility:hidden;position:absolute;z-index:100'><img src='"+InfoJet_WebContext+"images/infojet_progress_circle.gif'></div>";InfoJet_InsertAdjacentHTMLBeforeEnd(InfoJet_Container,c);InfoJet_Progress=document.getElementById("xdoc_progress")}if(InfoJet_Canvas==null){var a=null;if(InfoJet_IsCanvasTranparent){a="<div id='xdoc_canvas' oncontextmenu='return InfoJet_OnCanvasContextMenu(event);' style='width:0px;height:0px;position:absolute;z-index:99;background:#FFFFFF;filter:alpha(opacity=0);-moz-opacity:0;opacity:0;padding:0px;margin:0px;'>&nbsp;</div>"}else{a="<div id='xdoc_canvas' oncontextmenu='return InfoJet_OnCanvasContextMenu(event);' style='width:0px;height:0px;position:absolute;z-index:99;background:#FFFFFF;filter:alpha(opacity=50);-moz-opacity:0.5;opacity:0.5;padding:0px;margin:0px;'>&nbsp;</div>"}InfoJet_InsertAdjacentHTMLBeforeEnd(InfoJet_Container,a);InfoJet_Canvas=document.getElementById("xdoc_canvas");if(!InfoJet_IsIE()){var b="<input type='text' id='xdoc_focus_holder' style='width:0px;height:0px;position:absolute;display:none;'></input>";InfoJet_InsertAdjacentHTMLBeforeEnd(document.body,b);InfoJet_FocusHolder=document.getElementById("xdoc_focus_holder")}}}function InfoJet_MoveProgress2Position(b,a){if(InfoJet_ShowProgress&&InfoJet_Progress!=null){InfoJet_Progress.style.left=b;InfoJet_Progress.style.top=a}}function InfoJet_MoveProgress2CentralPosition(){if(InfoJet_ShowProgress&&InfoJet_Progress!=null){InfoJet_Progress.style.left=document.body.clientWidth/2-InfoJet_Progress.offsetWidth+document.body.scrollLeft;InfoJet_Progress.style.top=document.body.clientHeight/2-InfoJet_Progress.offsetHeight+document.body.scrollTop}}function InfoJet_MoveProgress2ControlPosition(c){if(InfoJet_ShowProgress&&InfoJet_Progress!=null){if(c){var d=c.offsetWidth/2+InfoJet_Progress.offsetWidth/2;var b=c.offsetHeight/2+InfoJet_Progress.offsetHeight/2;try{var f=InfoJet_GetPos(c);if(f==null){return}InfoJet_Progress.style.left=f.left+c.offsetWidth-d;InfoJet_Progress.style.top=f.top+c.offsetHeight-b}catch(a){InfoJet_MoveProgress2CentralPosition()}}else{InfoJet_MoveProgress2CentralPosition()}}}function InfoJet_MoveProgress2MousePosition(a){if(InfoJet_ShowProgress&&InfoJet_Progress!=null){if(a){InfoJet_Progress.style.left=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;InfoJet_Progress.style.top=a.clientY+document.body.scrollTop+document.documentElement.scrollTop}else{InfoJet_MoveProgress2CentralPosition()}}}function InfoJet_StartProgress(){if(InfoJet_Progress!=null){InfoJet_Progress.style.visibility="visible"}if(InfoJet_Canvas!=null){var a=document.getElementById("xdoc");if(a!=null){var b=InfoJet_GetPos(a);if(b==null){return}InfoJet_Canvas.style.left=b.left;InfoJet_Canvas.style.top=b.top;InfoJet_Canvas.style.width=a.offsetWidth;InfoJet_Canvas.style.height=a.offsetHeight}}}function InfoJet_StopProgress(){if(InfoJet_Progress!=null){InfoJet_Progress.style.visibility="hidden"}if(InfoJet_Canvas!=null){InfoJet_Canvas.style.width="0px";InfoJet_Canvas.style.height="0px"}}function InfoJet_SubmitToHost(source){if(InfoJet_ValidSubmit&&(!InfoJet_IsValid())&&(!InfoJet_NoValidation)){alert(InfoJet_LocalResources.CorrectFirstMessage);return}if(InfoJet_IsFuncDefined("InfoJetCustom_SubmitToHost")){eval("InfoJetCustom_SubmitToHost();")}else{var form=null;var element=InfoJet_GetParent(source);while(element!=null){if(element.tagName.toLowerCase()=="form"){form=element;break}element=InfoJet_GetParent(element)}if(form!=null){form.submit()}}}function InfoJet_Try2CloseWindow(b){var a=null;if(InfoJet_UseAjax){a=window}else{a=window.parent}if(b){if(a.InfoJet_Changed){if(a.confirm(InfoJet_LocalResources.CloseAnywayMessage)){InfoJet_CloseWindow(a)}}else{InfoJet_CloseWindow(a)}}else{InfoJet_CloseWindow(a)}}function InfoJet_CloseWindow(a){if(InfoJet_IsFuncDefined("InfoJetCustom_CloseWindow")){InfoJetCustom_CloseWindow(a)}else{if(InfoJet_IsIE()){if(InfoJet_IsIE7()){a.open("","_parent","");a.close()}else{a.opener=null;a.close()}}else{a.close()}}}function InfoJet_IsIdInIds(c,b){for(var a=0;a<b.length;a++){if(b[a]==c){return true}}return false}function InfoJet_FocusFirstControlAutomatically(){if(!InfoJet_IsInited()){InfoJet_FocusFirstControlAfterInited=true;return}try{var b=document.getElementById("xdoc_view");if(b!=null){var a=InfoJet_FindFocusableControlInElement(b);if(a!=null){a.setAttribute("noTextSelection","true");window.setTimeout(function(){try{a.focus()}catch(d){}},100)}}}catch(c){}}function InfoJet_OnOpenView(isFirstView){if(typeof(InfoJetCustom_OnOpenView)!="undefined"){eval("InfoJetCustom_OnOpenView( "+isFirstView+" );")}else{if(!isFirstView){if(InfoJet_ScrollFollowUpFormViewIntoView){var xdoc=document.getElementById("xdoc");xdoc.scrollIntoView()}else{window.scroll(0,0)}}InfoJet_FocusFirstControlAutomatically()}}function InfoJet_SelectText(a,b){var c=document.getElementById(a);if(c!=null){c.scrollIntoView();window.setTimeout(function(){c.focus()},100)}}function InfoJet_RefreshXmlToEditItem(d,a){var b=document.getElementById("xdoc_menu_focus_arrow");if(b==null){return null}var e=InfoJet_GetItemXmlToEdits(d);if(e.xmlToEditNames.length>0){var c=e.itemElement;if(a){b.setAttribute("itemId",InfoJet_GetElementId(c));b.setAttribute("itemHtmlId",c.id)}return c}else{if(a){b.setAttribute("itemId",document.getElementById("xdoc_data_root_element_id").innerHTML);b.setAttribute("itemHtmlId","xdoc_view")}return null}}function InfoJet_GetItemXmlToEdits(e){if(InfoJet_XmlToEditItems==null){var h=document.getElementById("xdoc_data_xmltoedit_name_array").innerHTML.split(";");var b=new Array();for(var c=0;c<h.length;c++){var d=document.getElementById(h[c]+"_item");if(d!=null){var a=d.innerHTML.split(";");var g=new Object();g.name=h[c];g.items=a;b[b.length]=g}}InfoJet_XmlToEditItems=b}var f=new Object();f.xmlToEditNames=new Array();InfoJet_GetItemElement(f,InfoJet_XmlToEditItems,e);return f}function InfoJet_GetItemElement(f,c,e){if(e==null||e.id=="xdoc_view"||e.tagName.toLowerCase()=="body"){return}for(var d=0;d<c.length;d++){var b=c[d].items;for(var a=0;a<b.length;a++){if(b[a]!=""){if(InfoJet_GetElementId(e)==b[a]){f.xmlToEditNames[f.xmlToEditNames.length]=c[d].name}}}}if(f.xmlToEditNames.length>0){f.itemElement=e;return}InfoJet_GetItemElement(f,c,InfoJet_GetParent(e))}function InfoJet_OnKeyPress(d,f){if(d.keyCode==13){if(f.tagName.toLowerCase()=="textarea"){var b=f.getAttribute("default_rows");if(b!=null&&b=="1"){if(InfoJet_IsIE()){d.returnValue=false}else{d.preventDefault()}}}}if(InfoJet_IsTextControl(f)){var a=InfoJet_GetTextControlMaxLength(f);if(a>0){if(f.value.length>=a){var c=f.getAttribute(InfoJet_XdPrefix+"ghosted");if(c==null||c=="false"){if(InfoJet_IsIE()){d.returnValue=false}else{var e=d.keyCode;if(!(e==37||e==39||e==8||e==9)){d.preventDefault()}}}}}}}function InfoJet_GetTextControlMaxLength(d){var b=d.getAttribute("textControlMaxLength");if(b==null){var k=false;var c=document.getElementById("xdoc_data_max_length_list").innerHTML;if(c.length>0){var f=c.split(";");for(var e=0;e<f.length;e++){var h=f[e].split(",");var a=h[0];var g=h[1];var j=InfoJet_GetElementId(d);if(j==a){b=g;d.setAttribute("textControlMaxLength",b);k=true;break}}}if(!k){b="0";d.setAttribute("textControlMaxLength",b)}}return parseInt(b,10)}function InfoJet_TrimByMaxLength(b){var a=InfoJet_GetTextControlMaxLength(b);if(a>0){if(b.value.length>a){b.value=b.value.substring(0,a)}}}function InfoJet_IsComboxPostback(c){var b=c.getAttribute("logic_tags");if(b!=null&&b.length>0){return true}var d=c.getAttribute("server_control");if(d==null||d=="yes"){return true}var a=InfoJet_GetSchemaType(c);if(a!=null&&a=="unknown"){return true}return false}function InfoJet_OnKeyDown(a,f){a=InfoJet_GetEvent(a);if(a.keyCode==40){if(f.className!=null&&f.className.indexOf("ComboBoxTextField")>0){var k=InfoJet_GetNextElement(f);if(!InfoJet_IsComboxPostback(f)){k.size=k.options.length;k.style.zIndex=100;var i=InfoJet_GetPos(f);if(i==null){return}k.style.top=i.top+f.offsetHeight;k.setAttribute("oldClip",k.style.clip);k.style.clip="rect(auto auto auto auto)";var j=k.onchange;k.setAttribute("onchangeFunc",j);k.onchange=null;k.focus()}}else{if(f.isDTText!=null&&f.isDTText=="true"){var h=f.dtButton;if(!h){var g=InfoJet_GetParent(f);var e=InfoJet_GetParent(g);var b=InfoJet_GetNextElement(e);h=InfoJet_GetFirstChild(b)}if(h!=null){f.setAttribute("needsFocus","true");a.keyCode=0;h.focus();h.onclick()}}}}if(a.keyCode==13||a.keyCode==27){if(f.className!=null&&f.className.indexOf("xdComboBox")==0){var d=f.getAttribute("oldClip");if(d!=null){f.style.clip=d;f.style.top="";f.size=1;var j=f.getAttribute("onchangeFunc");if(j!=null){f.onchange=j}InfoJet_OnControlChange(null,f);var c=InfoJet_GetPreviousElement(f);c.focus()}}}InfoJet_ResizeTextArea(f,true);if(InfoJet_OnKeyDown_xField(a,f)){return}if(InfoJet_OnKeyDown_xTextList(a,f)){return}}function InfoJet_OnKeyUp(a,b){a=InfoJet_GetEvent(a);if(InfoJet_EnableReplaceGroupingSymbol){InfoJet_ReplaceGroupingSymbol(a,b)}}function InfoJet_ReplaceGroupingSymbol(c,d){var a=InfoJet_GetSchemaType(d);if(a=="double"){var b=InfoJet_GetDataFmtType(d);if(b==null||b=="number"||b=="percentage"){if(d.value.indexOf(InfoJet_NumberGroupSeparator)>=0){var e=d.value;while(e.indexOf(InfoJet_NumberGroupSeparator)>=0){e=e.replace(InfoJet_NumberGroupSeparator,InfoJet_NumberDecimalSeparator)}d.value=e}}else{if(b=="currency"){if(d.value.indexOf(InfoJet_CurrencyGroupSeparator)>=0){var e=d.value;while(e.indexOf(InfoJet_CurrencyGroupSeparator)>=0){e=e.replace(InfoJet_CurrencyGroupSeparator,InfoJet_CurrencyDecimalSeparator)}d.value=e}}}}}function InfoJet_IsProofingControl(e,d){if(d&&InfoJet_NonProofingNodeNameArrays&&InfoJet_CurrentViewName){var c=InfoJet_NonProofingNodeNameArrays[InfoJet_CurrentViewName];for(var b=0;b<c.length;b++){var a=c[b];var f=d.lastIndexOf(a);if(f>0&&f==(d.length-(a.length))){return false}}}return true}function InfoJet_GetDataFmtType(a){var d=a.getAttribute(InfoJet_XdPrefix+"datafmt");if(d==null||d.length<=0){return null}var c=d.split('","');if(c.length>=2){var b=c[0];b=b.substr(1,b.length-1);return b}return null}function InfoJet_GetDataFmtFacetValue(g,e){var l=g.getAttribute(InfoJet_XdPrefix+"datafmt");if(l==null||l.length<=0){return null}var d=l.split('","');if(d.length>=2){var k=d[0];var c=d[1];k=k.substr(1,k.length-1);c=c.substr(0,c.length-2);var f=c.split(";");for(var h=0;h<f.length;h++){var b=f[h];if(b.length>0){var j=b.split(":");if(j.length>=2){var m=j[0];var a=j[1];if(m==e){return a}}}}}return null}function InfoJet_OnKeyDown_xField(b,c){var a=c.tagName.toLowerCase();if(b.keyCode==13){if(InfoJet_IsIdInArray(InfoJet_GetElementId(c),"xdoc_data_nobreak_id_array")){if(a=="textarea"){b.returnValue=false;return true}}}return false}function InfoJet_IsMultipleLineTextArea(c){if(c.tagName==null){return false}var b=c.tagName.toLowerCase();if(b!="textarea"){return false}if(c.getAttribute("hasScrollBar")=="true"){return false}var a=c.getAttribute("default_rows");if(a!=null&&a=="1"){return false}return true}function InfoJet_ResizeTextArea(c,b){if(!InfoJet_IsMultipleLineTextArea(c)){return}var j=c.value;var d=j.length;var k=1;var h=0;for(var f=0;f<d;f++){if(j.charAt(f).charCodeAt(0)==13){if(f-h>c.cols){k=k+((f-h)/c.cols)+1}else{k=k+1}h=f}}if(j.indexOf("\n")<0){k=d/c.cols+1}var a=c.rows;if(c.style.cssText.indexOf("OVERFLOW-Y: scroll;OVERFLOW-X: scroll;")<0){c.rows=k}if(b&&a!=k){if(!InfoJet_BrowserQuick){InfoJet_HideBorder("xdoc_field_over");InfoJet_HideBorder("xdoc_item_over");InfoJet_ShowFieldBorder(c,"xdoc_field_focus");if(InfoJet_ItemElement!=null){try{InfoJet_ShowFocusMenuArrow(InfoJet_ItemElement);InfoJet_ShowSectionBorder(InfoJet_ItemElement,"xdoc_item_focus")}catch(g){}}InfoJet_RelayoutFieldStyles()}}}function InfoJet_OnKeyDown_xTextList(d,f){var a=d.keyCode;if(a==13||a==8){if(InfoJet_IsTextControl(f)){if(a==8){if(f.value.length>0){return false}else{d.keyCode=0}}}var e=document.getElementById("xdoc_data_list_id_array").innerHTML.split(";");for(index=0;index<e.length;index++){var c=e[index];var g=InfoJet_GetElementId(f);if(c.indexOf(g)==0){InfoJet_OldValueState.valid=true;InfoJet_UpdateField(f);InfoJet_RefreshContext(f);var b=c.substr(g.length+1);document.getElementById("xdoc_param_xml_to_edit_name").value=b;if(a==13){document.getElementById("xdoc_param_xml_to_edit_action").value="xTextList::newItem"}else{if(a==8){document.getElementById("xdoc_param_xml_to_edit_action").value="xTextList::deleteItem"}}InfoJet_MoveProgress2ControlPosition(f);document.getElementById("xdoc_param_command").value="Update_XmlToEdit";f.setAttribute("postbacked","true");InfoJet_Submit();InfoJet_CancelEvent(d);d.returnValue=false;return true}}}return false}function InfoJet_RemoveFile(e){if(InfoJet_EnablePlaceholderUI){var a=InfoJet_GetPureId(e.id);var b=InfoJet_GetWriteOnlyField("xdoc"+e.id);b.value="";InfoJet_PostbackOnControl(e)}else{e.innerHTML="&nbsp;"+InfoJet_SelectFileMessage+"&nbsp";e.href="javascript:void(0)";var b=InfoJet_GetWriteOnlyField("xdoc"+e.id);b.value="";InfoJet_UpdateXDocumentDOM(b);var d=InfoJet_GetParent(e);var c=InfoJet_GetPSVI(d);if(c!=null&&c.type=="base64Binary"&&c.nillable=="false"){InfoJet_AddSchemaError(e.id);InfoJet_ShowSchemaError(e.id)}window.setTimeout("InfoJet_RelayoutFieldStyles();",100)}}function InfoJet_AttachFile(fileAttachment){InfoJet_HideBorder("xdoc_field_focus");var fileAttachmentElement=null;if(InfoJet_EnablePlaceholderUI){fileAttachmentElement=fileAttachment}else{fileAttachmentElement=InfoJet_GetParent(fileAttachment)}if(fileAttachmentElement!=null){var disableEditing=fileAttachmentElement.getAttribute(InfoJet_XdPrefix+"disableEditing");if(disableEditing!=null&&disableEditing.toLowerCase()=="yes"){return}}if(InfoJet_IsFuncDefined("InfoJetCustom_AttachFile")){var formId=document.getElementById("xdoc_param_form_id").value;eval("InfoJetCustom_AttachFile( fileAttachment, formId );");return}var formId=document.getElementById("xdoc_param_form_id").value;var allowedFileTypes=fileAttachmentElement.getAttribute("allowedFileTypes");var uploadedFile=window.showModalDialog(InfoJet_WebContext+"js/uploadfile_dialog.htm",new Array(window,fileAttachment,formId,allowedFileTypes),"dialogWidth:470px;dialogHeight:125px;help:no;");if(uploadedFile!=null){if(InfoJet_EnablePlaceholderUI){var pureId=InfoJet_GetPureId(fileAttachment.id);var file=InfoJet_GetWriteOnlyField("xdoc"+pureId);file.value=uploadedFile.content;InfoJet_PostbackOnControl(fileAttachment)}else{InfoJet_LinkUploadedFile(fileAttachment,uploadedFile);var fileAttachmentSpan=InfoJet_GetParent(fileAttachment);var psvi=InfoJet_GetPSVI(fileAttachmentElement);if(psvi!=null&&psvi.type=="base64Binary"&&psvi.nillable=="false"){InfoJet_RemoveError(fileAttachment.id,"schema");InfoJet_HideError(fileAttachment.id)}window.setTimeout("InfoJet_RelayoutFieldStyles();",100)}}}function InfoJet_LinkUploadedFile(b,g){var a=InfoJet_GetPureId(b.id);if(b.href==null){b=document.getElementById(a+",1")}var d=g.path;b.href=d;var c=g.name;var f=g.size;b.innerHTML="&nbsp;"+c+"&nbsp;"+f+"&nbsp;";var e=InfoJet_GetWriteOnlyField("xdoc"+a);e.value=g.content;InfoJet_UpdateXDocumentDOM(e)}function InfoJet_OnHyperlinkBoxClick(a){if(a.tagName&&a.tagName.toLowerCase()=="button"){a=a.parentNode}var c=InfoJet_GetFirstChild(a);if(c.disabled){return false}var d="help:no;dialogWidth:350px;";var b=a.getAttribute("binding_secondary_id");if(b!=null&&b.length>0){d=d+"dialogHeight:125px;"}else{d=d+"dialogHeight:90px;"}window.showModalDialog(InfoJet_WebContext+"js/editlink_dialog.htm",new Array(window,a),d);return false}function InfoJet_AddHyperlinkBoxOnClick(a){window.setTimeout(function(){a.onclick=function(){return InfoJet_OnHyperlinkBoxClick(this)}},0)}function InfoJet_OnRichTextBoxFocus(e,f){InfoJet_FocusControlId=f.id;if(InfoJet_Postbacking>0){return}var c=f.getAttribute(InfoJet_XdPrefix+"disableEditing");if(c!=null&&c.toLowerCase()=="yes"){f.contentEditable=false;return}var b=f.getAttribute("readonly");if(b!=null&&b.toLowerCase()=="true"){f.contentEditable=false;return}if(!InfoJet_EditRichTextOnFocus){var h=InfoJet_GetPos(f);if(h==null){return}var d=f.getAttribute("IsEditing");if(d!="true"){var g=document.getElementById("xdoc_menu_rtb_edit");g.setAttribute("rtb_id",f.id);g.style.left=h.left-18+2;g.style.top=h.top+2;g.style.display="block"}}else{var a=InfoJet_GetPureId(f.id);InfoJet_InstanceNicEdit(f,a)}}function InfoJet_OnRichTextBoxEditClick(c,e){var f=document.getElementById("xdoc_menu_rtb_edit");f.style.display="none";var a=f.getAttribute("rtb_id");f.removeAttribute(a);if(a){var d=document.getElementById(a);var b=InfoJet_GetPureId(a);InfoJet_InstanceNicEdit(d,b)}}function InfoJet_BuildRTBEditClickHandler(){var a=null;if(InfoJet_IsIE()){a=function(){InfoJet_OnRichTextBoxEditClick(null,this)}}else{a=function(b){return InfoJet_OnRichTextBoxEditClick(b,this)}}return a}function InfoJet_InstanceNicEdit(d,b){if(InfoJet_NicEditor_PaneExisting){InfoJet_NicEditor_PaneExisting=false;return}if(InfoJet_OldValueState){var a=new NicEditXHTML();var e=a.saveXhtml(d);InfoJet_OldValueState.textValue=e}var c=d.getAttribute("isEditing");if(c=="true"){return}d.setAttribute("isEditing","true");InfoJet_NicEditor=new nicEditor({iconsPath:InfoJet_WebContext+"images/nicEditorIcons.gif"});InfoJet_NicEditor.setPanel(InfoJet_RtbPanel);InfoJet_NicEditor.addInstance(d);var f=InfoJet_GetPos(d);InfoJet_RtbPanel.style.height=22*1;InfoJet_RtbPanel.style.width=396;InfoJet_RtbPanel.style.left=f.left;InfoJet_RtbPanel.style.top=f.top-22*1;InfoJet_RtbPanel.style.display="block"}function InfoJet_OnNicEditBlur(c){if(InfoJet_NicEditor_PaneExisting){return}var b=new NicEditXHTML();var e=b.saveXhtml(c);var a=InfoJet_GetPureId(c.id);InfoJet_RtbPanel.style.display="none";InfoJet_NicEditor.removeInstance(c);InfoJet_NicEditor=null;c.removeAttribute("isEditing");c.contentEditable=true;var d=document.getElementById("xdoc"+a);if(d.value!=e){d.value=e;document.getElementById("xdoc_param_old_value").value=e;InfoJet_MoveProgress2ControlPosition(c);InfoJet_CheckPostback(c,false,false)}}function InfoJet_BuildMouseOutHandler(){var a=null;if(InfoJet_IsIE()){a=function(){InfoJet_OnMouseOut(null,this)}}else{a=function(b){InfoJet_OnMouseOut(b,this)}}return a}function InfoJet_BuildDocMouseOutHandler(){var a=null;if(InfoJet_IsIE()){a=function(){InfoJet_OnMouseOut(window.event,window.event.srcElement)}}else{a=function(b){InfoJet_OnMouseOut(b,b.target)}}return a}function InfoJet_BuildMouseOverHandler(a){var b=null;if(InfoJet_IsIE()){b=function(){InfoJet_OnMouseOver(null,this,a)}}else{b=function(c){InfoJet_OnMouseOver(c,this,a)}}return b}function InfoJet_BuildDocMouseOverHandler(a){var b=null;if(InfoJet_IsIE()){b=function(){InfoJet_OnMouseOver(window.event,window.event.srcElement,a)}}else{b=function(c){InfoJet_OnMouseOver(c,c.target,a)}}return b}function InfoJet_BuildBlurHandler(a){var b=null;if(InfoJet_IsIE()){b=function(){InfoJet_OnBlur(null,this,a)}}else{b=function(c){InfoJet_OnBlur(c,this,a)}}return b}function InfoJet_BuildDocBlurHandler(a){var b=null;if(InfoJet_IsIE()){b=function(){InfoJet_OnBlur(window.event,window.event.srcElement,a)}}else{b=function(c){InfoJet_OnBlur(c,c.target,a)}}return b}function InfoJet_BuildFocusHandler(b){var a=null;if(InfoJet_IsIE()){a=function(){InfoJet_OnFocus(null,this,b)}}else{a=function(c){InfoJet_OnFocus(c,this,b)}}return a}function InfoJet_BuildDocFocusHandler(b){var a=null;if(InfoJet_IsIE()){a=function(){InfoJet_OnFocus(window.event,window.event.srcElement,b)}}else{a=function(c){InfoJet_OnFocus(c,c.target,b)}}return a}function InfoJet_BuildDocClickHandler(a){var b=null;if(InfoJet_IsIE()){b=function(){if(event.srcElement.onclick==null){InfoJet_OnClick(window.event,window.event.srcElement,a)}}}else{b=function(c){if(c.target.onclick==null){InfoJet_OnClick(c,c.target,a)}}}return b}function InfoJet_BuildContextMenuHandler(){var a=null;if(InfoJet_IsIE()){a=function(){InfoJet_OnContextMenu(null,this)}}else{a=function(b){return InfoJet_OnContextMenu(b,this)}}return a}function InfoJet_BuildDocContextMenuHandler(){var a=null;if(InfoJet_IsIE()){a=function(){InfoJet_OnContextMenu(window.event,window.event.srcElement)}}else{a=function(b){return InfoJet_OnContextMenu(b,b.target)}}return a}function InfoJet_BuildMenuArrowPointHandler(b){var a=null;if(InfoJet_IsIE()){a=function(){InfoJet_OnMenuArrowPoint(null,this,b)}}else{a=function(c){return InfoJet_OnMenuArrowPoint(c,this,b)}}return a}function InfoJet_FormatTextArea(){var c=document.getElementById("xdoc_data_textarea_id_array").innerHTML;var e=c.split(";");for(var b=0;b<e.length;b++){var a=e[b];if(a.length>0){var d=document.getElementById(a);if(d!=null){InfoJet_ResizeTextArea(d,false)}}}}function InfoJet_OnDatePickerClick(c,h,e){var i=null;if(e){i=InfoJet_GetPreviousElement(h)}else{var d=InfoJet_GetParent(h);var f=InfoJet_GetPreviousElement(d);var g=InfoJet_GetFirstChild(f);i=InfoJet_GetFirstChild(g)}var a=i.getAttribute("date_num");if(a==null){a=i.getAttribute(InfoJet_XdPrefix+"num")}var j=a.indexOf("T");if(j>0){a=a.substring(0,j)}if(a==null){a=""}i.setAttribute("date_num",a);if(!i.dtButton){var b=InfoJet_GetDateFormat(i);i.dtButton=h;Calendar.setup({xdocInputField:i,ifFormat:b,showsTime:false,xdocButton:h,singleClick:true,step:1,onClose:InfoJet_OnCalendarClose})}h.clickPickerButton();InfoJet_StopEvent(c);return false}function InfoJet_OnCalendarClose(c){c.hide();var a=c.params.xdocInputField;var b=a.getAttribute("needsFocus");if(b!=null&&b=="true"){a.removeAttribute("needsFocus");a.focus()}}function InfoJet_AlignDTPickerButton(a,b,c){b.style.textAlign=a.style.textAlign;if(InfoJet_IsIE()){b.style.top=a.clientTop;if(a.clientWidth-c.offsetWidth-2>0){b.style.width=a.clientWidth-c.offsetWidth-2}if(b.offsetLeft>0){b.style.marginLeft=-b.offsetLeft}if(a.clientHeight-2>0){b.style.height=a.clientHeight-2;b.style.lineHeight=b.style.height}}else{var d=InfoJet_GetStylePixelSize(a,"width","width");b.style.width=d-c.offsetWidth-2;a.style.paddingTop="2px";a.style.paddingBottom="2px"}}function InfoJet_FormatDTPicker(){var c=document.getElementById("xdoc_data_datepicker_id_array");if(c!=null){var g=c.innerHTML;var h=g.split(";");for(var e=0;e<h.length;e++){var d=h[e];if(d.length>0){var f=document.getElementById(d);if(f!=null){var a=InfoJet_GetParent(f);var b=InfoJet_GetNextElement(f);InfoJet_AlignDTPickerButton(a,f,b)}}}}}function InfoJet_FormatComboBox(){var c=document.getElementById("ComboBoxPlaceholder");var d=1;while(c!=null){var b=InfoJet_GetNextElement(c);var a=InfoJet_GetNextElement(b);var e=c.offsetWidth;b.style.width=e;b.style.marginLeft="-"+e;a.style.width=e;a.style.marginLeft="-"+e;a.style.clip="rect(auto auto auto "+(e-18)+")";b.style.height=a.offsetHeight;c=document.getElementById("ComboBoxPlaceholder,"+d);d++}}function InfoJet_BuildMenuArrowPoint(){var e=false;var a=document.getElementById("xdoc_arrow");if(a.innerHTML=="ReadonlyView"){e=true}var b="<div id='xdoc_menu_focus_arrow' style='display: none;Z-INDEX: 98;POSITION: absolute;'>";b+="<img id='xdoc_menu_focus_arrow_img' src='"+InfoJet_WebContext+"images/infojet_transparent.gif'></img></div>";if(!InfoJet_EditRichTextOnFocus){b+="<div id='xdoc_menu_rtb_edit' style='display: none;Z-INDEX: 97;POSITION: absolute;'>";b+="<img id='xdoc_menu_rtb_edit_img' src='"+InfoJet_WebContext+"Images/infojet_menu_rtb_edit.gif'></img></div>"}b+="<div id='xdoc_menu_rtb_panel' style='display: none;Z-INDEX: 97;POSITION: absolute;'></div>";a.innerHTML=b;var d=document.getElementById("xdoc_menu_focus_arrow");d.onblur=function(){InfoJet_OnBlur("menu")};d.onclick=InfoJet_BuildMenuArrowPointHandler("arrow");d.oncontextmenu=InfoJet_BuildMenuArrowPointHandler("arrow");if(!InfoJet_EditRichTextOnFocus){var c=document.getElementById("xdoc_menu_rtb_edit");c.onblur=function(){InfoJet_OnBlur("menu")};c.onclick=InfoJet_BuildRTBEditClickHandler();c.oncontextmenu=function(){return}}InfoJet_RtbPanel=document.getElementById("xdoc_menu_rtb_panel");if(e){d.onclick="javascript:void(0)";d.oncontextmenu="javascript:void(0)"}}function InfoJet_Init(){var xdoc=document.getElementById("xdoc");if(!xdoc){return}InfoJet_XdPrefix=document.getElementById("xdoc_data_xd_prefix").innerHTML;if(typeof(InfoJetCustom_InitContainer)!="undefined"){InfoJetCustom_InitContainer(xdoc)}if(InfoJet_Container==null){InfoJet_Container=document.body}if(typeof(InfoJetCustom_ResetOffset)!="undefined"){InfoJetCustom_ResetOffset()}var menu=document.getElementById("xdoc_data_menu");var menuHtml=menu.getAttribute("html");if(menuHtml.length>0){var xdocMenu=document.getElementById("xdoc_menu");if(xdocMenu!=null){InfoJet_RemoveHtmlElement(xdocMenu)}InfoJet_InsertAdjacentHTMLBeforeEnd(document.body,menuHtml)}var style=document.getElementById("xdoc_fieldstyle");if(style!=null){style.innerHTML=""}else{InfoJet_InsertAdjacentHTMLBeforeEnd(InfoJet_Container,"<div id='xdoc_fieldstyle' style='width:0px;height:0px;'></div>")}var focus=document.getElementById("xdoc_focusover");if(focus==null){InfoJet_InsertAdjacentHTMLBeforeEnd(InfoJet_Container,"<div id='xdoc_focusover' style='width:0px;height:0px;'></div>");InfoJet_BuildFocusOverBorder()}var arrow=document.getElementById("xdoc_arrow");if(arrow==null){InfoJet_InsertAdjacentHTMLBeforeEnd(InfoJet_Container,"<div id='xdoc_arrow' style='width:0px;height:0px;'></div>");InfoJet_BuildMenuArrowPoint()}InfoJet_BuildProgress();if(InfoJet_HookDocumentOnClickEvent){document.onclick=InfoJet_BuildDocClickHandler("common")}else{xdoc.onclick=InfoJet_BuildDocClickHandler("common")}xdoc.oncontextmenu=InfoJet_BuildDocContextMenuHandler("common");xdoc.onblur=InfoJet_BuildDocBlurHandler("common");if(!InfoJet_BrowserQuick){xdoc.onmouseover=InfoJet_BuildDocMouseOverHandler("common");xdoc.onmouseout=InfoJet_BuildDocMouseOutHandler()}InfoJet_ShortDatePattern=document.getElementById("xdoc_data_short_date_pattern").innerHTML;InfoJet_LongDatePattern=document.getElementById("xdoc_data_long_date_pattern").innerHTML;InfoJet_YearMonthPattern=document.getElementById("xdoc_data_year_month_pattern").innerHTML;InfoJet_FormatDTPicker();InfoJet_FormatTextArea();InfoJet_FormatComboBox();if(!InfoJet_NoValidation){InfoJet_ShowAllErrors()}InfoJet_HiddenAllGroupMenu();InfoJet_HideOverBorderArrow();InfoJet_HideFocusBorderArrow();window.onresize=InfoJet_OnWindowResize;if(InfoJet_FuncAfterInit!=null){eval(InfoJet_FuncAfterInit);InfoJet_FuncAfterInit=null}InfoJet_XmlToEditItems=null;InfoJet_Inited();if(InfoJet_PingParameter!=null){if(!InfoJet_IsPinging){window.setTimeout("InfoJet_Ping();",InfoJet_PingInterval);InfoJet_IsPinging=true}}if(InfoJet_FocusFirstControlAfterInited){InfoJet_FocusFirstControlAfterInited=false;InfoJet_FocusFirstControlAutomatically()}InfoJet_BuildXDocumentDOM()}function InfoJet_Inited(){var a=document.getElementById("xdoc");a.setAttribute("inited","true")}function InfoJet_IsInited(){var b=document.getElementById("xdoc");if(b==null){return false}var a=b.getAttribute("inited");if(a!=null&&a=="true"){return true}else{return false}}function InfoJet_ReloadForm(){var b=InfoJet_GetFrameDocument("xdoc_frame");var d=b.getElementById("xdoc_view");var a=b.getElementById("xdoc_form");var c=b.getElementById("xdoc_data");if(d.value.length>0){document.getElementById("xdoc_view").innerHTML=d.value}document.getElementById("xdoc_form").innerHTML=a.value;document.getElementById("xdoc_data").innerHTML=c.value;InfoJet_Init();InfoJet_Changed=true}function InfoJet_ReloadFormVars(c,b,a){if(c.length>0){document.getElementById("xdoc_view").innerHTML=c}document.getElementById("xdoc_form").innerHTML=b;document.getElementById("xdoc_data").innerHTML=a;InfoJet_Init();InfoJet_Changed=true}function InfoJet_OnWindowResize(){InfoJet_RelayoutFieldStyles();if(InfoJet_FocusControlId){var focusControl=document.getElementById(InfoJet_FocusControlId);if(focusControl&&InfoJet_NeedFieldBorder(focusControl)){InfoJet_ShowFieldBorder(focusControl,"xdoc_field_focus")}}if(typeof(Custom_InfoJetWebFormHost_OnWindowResize)!="undefined"){eval("Custom_InfoJetWebFormHost_OnWindowResize();")}}function InfoJet_RelayoutFieldStyles(){var g=document.getElementById("xdoc_fieldstyle");if(g==null){return}var d=new Array();var a=new Array();for(var e=0;e<g.childNodes.length;e++){var f=g.childNodes[e];if(f.nodeType==1){var b=f.id;if(b.lastIndexOf("_top")==(b.length-4)){if(parseInt(f.style.height)>0||parseInt(f.style.width)>0){d[d.length]=b.substr(0,b.length-4)}}if(b.lastIndexOf("_notBlank")==(b.length-9)){if(f.style.display!="none"){a[a.length]=b.substr(0,b.length-9)}}}}for(var c=0;c<d.length;c++){var h=document.getElementById(d[c]);if(h!=null){InfoJet_ShowInvalidateBorder(h)}}for(var c=0;c<a.length;c++){var h=document.getElementById(a[c]);if(h!=null){InfoJet_ShowNotBlankMark(h)}}}function InfoJet_SetViewReadonly(){var g=InfoJet_GetAllChildren(document.getElementById("xdoc_view"));for(var e=0;e<g.length;e++){var d=g[e];var c=d.tagName.toLowerCase();if(c=="input"){var f=d.getAttribute("type");if(f!=null){f=f.toLowerCase();if(f=="text"||f=="password"){d.readOnly=true;d.contentEditable=false}else{if(f!="button"){d.disabled=true}}}else{d.disabled=true}}else{if(c=="textarea"){d.readOnly=true;d.contentEditable=false}else{if(c=="select"){if(InfoJet_FormatReadonlyView){var h="";if(d.selectedIndex>=0){h=d.options[d.selectedIndex].text.replace(/\'/g,"\\'")}var b="<input type='text' class='xdTextBox' style='"+d.style.cssText+"' readOnly='true' value='"+h+"'/>";InfoJet_ReplaceNodeWithHTML(d,b)}else{d.disabled=true}}else{if(c=="button"){if(d.className!="xdPictureButton"){d.disabled=true}if(InfoJet_FormatReadonlyView){if(d.className&&d.className=="xdDTButton"){InfoJet_RemoveHtmlElement(d)}}}else{if(d.className&&d.className=="xdInlinePicture"){d.disabled=true}else{if(d.className&&d.className=="xdLinkedPicture"){d.disabled=true}else{if(d.className&&d.className=="xdFileAttachmentLink"){var a=d.href;if(a.indexOf("javascript:void(0)")==0){d.onclick=null}else{d.setAttribute("fileHref",a);d.href="javascript:void(0)";d.onclick=function(){window.open(this.getAttribute("fileHref"))}}}else{if(d.className&&d.className=="optionalPlaceholder"){if(InfoJet_IsIE()){d.disabled=true}else{d.setAttribute("disabled","true")}}}}}}}}}}InfoJet_RemoveFocus()}function InfoJet_GetFirstElementInNewStructureNode(){if(InfoJet_NewStructureNodeId!=null){var a=document.getElementById(InfoJet_NewStructureNodeId);if(a!=null){var b=InfoJet_FindFocusableControlInElement(a);if(b!=null){InfoJet_FocusControlId=b.id}}}}function InfoJet_RestoreFocus(){InfoJet_GetFirstElementInNewStructureNode();if(InfoJet_FocusControlId!=null){try{var f=document.getElementById(InfoJet_FocusControlId);if(f!=null){if(!InfoJet_IsReadyForFocus(f)){var b=InfoJet_FindNextFocusableControl(f);if(b!=null){f=b}}var c=f.getAttribute("isItemsContainer");if(c!=null&&c=="true"){InfoJet_RestoreFocusOnItemsContainer(f)}else{f.focus()}if(f.tagName.toLowerCase()=="input"){var a=f.getAttribute("type");if(a!=null&&a=="text"){f.select()}}}}catch(d){}}InfoJet_FocusControlId=null}function InfoJet_RestoreFocusOnItemsContainer(a){var e=false;if(InfoJet_FocusItemIndex!=-1){InfoJet_FocusItemIndex=InfoJet_FocusItemIndex*2;var d=InfoJet_GetElements(a);if(d.length>0){if(InfoJet_FocusItemIndex<d.length){d[InfoJet_FocusItemIndex].focus();e=true}else{d[d.length-2].focus();e=true}}}if(!e){var f=InfoJet_GetParent(a);var c=InfoJet_GetNextElement(f);var b=InfoJet_GetFirstChild(c);b.focus()}InfoJet_FocusItemIndex=-1}function InfoJet_OpenNewForm(a,b){if(typeof(InfoJetCustom_OpenNewForm)!="undefined"){InfoJetCustom_OpenNewForm(a,b)}else{alert("InfoJetCustom_OpenNewForm() is not defined.")}}function InfoJet_BuildXDocumentDOM(){var b=document.getElementById("xdoc_data_xml");if(b!=null){var a=b.getAttribute("xml");InfoJet_XDocumentDOM=new ActiveXObject("Msxml2.DOMDocument.3.0");if(InfoJet_XDocumentDOM==null){return}InfoJet_XDocumentDOM.loadXML(a)}else{InfoJet_XDocumentDOM=null}}function InfoJet_LoadXDocumentDOM(a){var b=document.getElementById("xdoc_data_xml");if(b!=null){b.innerHTML=a;var c=b.innerHTML;b.innerHTML="";if(InfoJet_XDocumentDOM!=null){InfoJet_XDocumentDOM.loadXML(c)}}}function InfoJet_UpdateXDocumentDOM(d){if(InfoJet_XDocumentDOM!=null&&d.id.indexOf("xdoc_s_")<0){var c=d.id.split("@");var a=c[0].replace("xdoc","");var b=InfoJet_XDocumentDOM.selectSingleNode("//*[@JetId='"+a+"']");if(b!=null){if(c.length==1){b.text=d.value}else{b.setAttribute(c[1],d.value)}}}}function InfoJet_UpdateFormFieldByDOMNode(g){var m=null;var l=null;if(g.nodeType==1){m=g.getAttribute("JetId");l=g.text}else{if(g.nodeType==2){var h=g.selectSingleNode("..");m=h.getAttribute("JetId");m=m+"@"+g.nodeName;l=g.value}}var c=document.getElementById("xdoc"+m);c.value=l;var j=null;for(var e=0;true;e++){var b=m;if(e!=0){b=b+","+e}var a=document.getElementById(b);if(a==null){break}else{if(e==0){j=a}var d=a.tagName.toLowerCase();if(d=="select"){a.value=l}else{if(d=="img"){a.src=l}else{if(d=="input"){var k=a.type.toLowerCase();if(k=="text"||k=="password"){a.setAttribute("xml_value",l);a.value=l}else{if(k=="checkbox"){var i=InfoJet_GetOnOffValue(a,true);var f=InfoJet_GetOnOffValue(a,false);if(i==l){a.checked=true}if(f==l){a.checked=false}}else{if(k=="radio"){var i=InfoJet_GetOnOffValue(a,true);if(i==l){a.checked=true}else{a.checked=false}}}}}else{if(d=="textarea"){a.setAttribute("xml_value",l);a.value=l}}}}}if(j!=null){InfoJet_OnControlChange(null,j)}}}function InfoJet_GetDateFormat(f){var k=f.getAttribute(InfoJet_XdPrefix+"datafmt");if(k==null||k.length<=0){return"%Y-%m-%d"}var d=k.split('","');if(d.length>=2){var j=d[0];var c=d[1];j=j.substr(1,j.length-1);c=c.substr(0,c.length-2);var e=c.split(";");for(var g=0;g<e.length;g++){var b=e[g];if(b.length>0){var h=b.split(":");if(h.length>=2){var l=h[0];var a=h[1];if(l=="dateFormat"){dateFormat=a;if(dateFormat.length<=0){return"%Y-%m-%d"}if(dateFormat=="Long Date"){dateFormat=InfoJet_LongDatePattern}if(dateFormat=="Year Month"){dateFormat=InfoJet_YearMonthPattern}if(dateFormat=="Short Date"){dateFormat=InfoJet_ShortDatePattern}if(dateFormat.indexOf("dddd")>=0){return"%Y-%m-%d"}if(dateFormat.indexOf("MMMM")>=0){return"%Y-%m-%d"}if(dateFormat.indexOf("MMM")>=0){return"%Y-%m-%d"}dateFormat=dateFormat.replace(/\'/g,"");if(dateFormat.indexOf("yyyy")>=0){dateFormat=dateFormat.replace("yyyy","%Y")}else{if(dateFormat.indexOf("yy")>=0){dateFormat=dateFormat.replace("yy","%Y")}}if(dateFormat.indexOf("MM")>=0){dateFormat=dateFormat.replace("MM","%m")}else{if(dateFormat.indexOf("M")>=0){dateFormat=dateFormat.replace("M","%m")}}if(dateFormat.indexOf("dd")>=0){dateFormat=dateFormat.replace("dd","%d")}else{if(dateFormat.indexOf("d")>=0){dateFormat=dateFormat.replace("d","%d")}}return dateFormat}}}}}return"%Y-%m-%d"}function InfoJet_DataFmt(d){var s=d.getAttribute(InfoJet_XdPrefix+"datafmt");if(s==null||s.length<=0){return 0}var q=s.split('","');if(q.length>=2){var e=q[0];var f=q[1];e=e.substr(1,e.length-1);f=f.substr(0,f.length-2);var k="",r="",o="",g="",h="",m="",j="",c="";var p=f.split(";");for(var n=0;n<p.length;n++){var b=p[n];if(b.length>0){var a=b.split(":");if(a.length>=2){var l=a[0];var t=a[1];if(l=="numDigits"){k=t}else{if(l=="grouping"){r=t}else{if(l=="negativeOrder"){o=t}else{if(l=="positiveOrder"){g=t}else{if(l=="currencyLocale"){h=t}else{if(l=="locale"){m=t}else{if(l=="dateFormat"){j=t}else{if(l=="timeFormat"){c=t}}}}}}}}}}}return InfoJet_DoFormat(d,e,k,r,o,g,h,m,j,c)}return 0}var InfoJet_LocaleIdArray=new Array("1052","1068","2092","1061","1069","1076","1026","3131","1083","2107","1132","1059","1039","1045","5146","1042","1074","1092","1030","3079","1031","5127","4103","2055","1049","1080","2060","1036","3084","5132","3076","6156","4108","1035","1087","2067","1043","1088","1110","1027","1029","1050","4122","1131","2155","3179","1062","1063","4155","5179","1048","1082","1086","2110","1071","1153","1104","1078","6203","7227","1044","4100","2068","1046","2070","1041","1053","2077","2074","3098","6170","7194","8251","1051","1060","1089","1055","1106","1058","1091","2115","11274","15370","6154","20490","16394","1034","7178","12298","9226","5130","3082","2052","18442","10250","2058","19466","17418","4106","8202","14346","13322","1032","1038","9275","2064","1040","1057","6153","3081","10249","13321","9225","4105","12297","1033","7177","11273","5129","8201","2057","5124","1028","1077","15361","3073","13313","14337","1054");var InfoJet_CurrencySymbolArray=new Array("Lek","man.","ман.","kr","€","$","лв","$","$","$","$","р.","kr.","zł","$","₩","$","р.","kr","€","€","CHF","€","SFr.","р.","kr","€","€","$","€","HK$","€","SFr.","€","Т","€","€","сом","€","€","Kč","kn","$","$","$","$","Ls","Lt","$","$","lei","$","R","$","ден.","$","₮","R","$","$","kr","$","kr","R$ ","€","¥","kr","€","Din.","Дин.","$","$","$","Sk","SIT","S","TL","$","грн.","su'm","сўм","$","Gs","B/.","$","$b","€","RD$","$","$","₡","€","￥","L.","S/.","$","C$","$","Q","Bs","$U","$","€","Ft","$","SFr.","€","Rp","€","$","BZ$","Php","$","$","Z$","$","R","TT$","$","J$","£","P","NT$","$","د.ب.","ج.م.","د.ك.","د.إ.","฿");function InfoJet_GetCurrencySybmol(b){for(var a=0;a<InfoJet_LocaleIdArray.length;a++){if(InfoJet_LocaleIdArray[a]==b){return InfoJet_CurrencySymbolArray[a]}}return"$"}function InfoJet_GetCurDecimalSeparator(b){for(var a=0;a<InfoJet_LocaleIdArray.length;a++){if(InfoJet_LocaleIdArray[a]==b){if(InfoJet_CurSeparatorTypeArray[a]=="1"){return"."}else{return","}}}return"."}function InfoJet_GetCurSeparatorType(b){for(var a=0;a<InfoJet_LocaleIdArray.length;a++){if(InfoJet_LocaleIdArray[a]==b){return InfoJet_CurSeparatorTypeArray[a]}}return"1"}var InfoJet_DateFormats=new Array("MM-dd-yyyy","MM-dd-yy","M-d-yyyy","M-d-yy","dd-MM-yyyy","dd-MM-yy","d-M-yyyy","d-M-yy","yyyy-MM-dd","yyyy-M-d","yy-MM-dd","yy-M-d","dd MMMM yyyy");function InfoJet_ParseDate(c){var a=null;for(var b=0;b<InfoJet_DateFormats.length;b++){var d=InfoJet_DateFormats[b];a=Date.parseString(c,d);if(a!=null){return a}}return null}function InfoJet_DoFormat(c,d,o,v,t,h,k,p,n,b){var m=InfoJet_GetControlValue(c);var e=InfoJet_GetSchemaType(c);if(e=="string"){return 1}if(m.length<=0){if(d=="boolean"||d=="string"||d=="anyURI"||d=="any"){return 1}if(d=="number"||d=="currency"||d=="percentage"){c.setAttribute("xml_value","");return 1}}if(d=="number"){var g="";var q="";var j=new NumberFormat154();if(InfoJet_NumberDecimalSeparator!="."&&InfoJet_NumberGroupSeparator!="."){m=m.replace(/\./g,InfoJet_NumberDecimalSeparator)}j.setInputDecimal(InfoJet_NumberDecimalSeparator);j.setNumber(m);j.setCurrencyValue("$");j.setCurrency(false);j.setCurrencyPosition(j.LEFT_OUTSIDE);j.setNegativeRed(false);if(o=="auto"){j.setPlaces("-1",false)}else{if(o=="0"){j.setPlaces(o,true)}else{j.setPlaces(o,false)}}if(v=="0"){j.setSeparators(false,",",",")}else{j.setSeparators(true,InfoJet_NumberGroupSeparator,InfoJet_NumberDecimalSeparator)}if(t=="0"){j.setNegativeFormat(j.PARENTHESIS)}else{if(t=="1"){j.setNegativeFormat(j.LEFT_DASH)}else{if(t=="2"){j.setNegativeFormat(j.LEFT_DASHSPACE)}else{if(t=="3"){j.setNegativeFormat(j.RIGHT_DASH)}else{if(t=="4"){j.setNegativeFormat(j.RIGHT_DASHSPACE)}}}}}g=j.toFormatted();if(j.isValid&&InfoJet_IsValidNumberChars(m)){if(e!=null&&e.indexOf("int")>=0){q=j.getOriginalInteger()}else{q=j.getOriginal()}c.value=g;c.setAttribute("xml_value",q);return 1}else{c.setAttribute("xml_value",m);return -1}}else{if(d=="currency"){var g="";var q="";var j=new NumberFormat154();if(InfoJet_CurrencyDecimalSeparator!="."&&InfoJet_CurrencyGroupSeparator!="."){m=m.replace(/\./g,InfoJet_CurrencyDecimalSeparator)}j.setInputDecimal(InfoJet_CurrencyDecimalSeparator);j.setNumber(m);j.setNegativeRed(false);if(o=="auto"){j.setPlaces("-1",false)}else{if(o=="0"){j.setPlaces(o,true)}else{j.setPlaces(o,false)}}if(v=="0"){j.setSeparators(false,",",",")}else{j.setSeparators(true,InfoJet_CurrencyGroupSeparator,InfoJet_CurrencyDecimalSeparator)}var i=InfoJet_GetCurrencySybmol(k);if(t=="0"&&h=="0"){j.setNegativeFormat(j.PARENTHESIS);j.setCurrencyPosition(j.LEFT_INSIDE)}else{if(t=="1"&&h=="0"){j.setNegativeFormat(j.LEFT_DASH);j.setCurrencyPosition(j.LEFT_INSIDE)}else{if(t=="2"&&h=="0"){j.setNegativeFormat(j.LEFT_DASH);j.setCurrencyPosition(j.LEFT_OUTSIDE)}else{if(t=="3"&&h=="0"){j.setNegativeFormat(j.RIGHT_DASH);j.setCurrencyPosition(j.LEFT_INSIDE)}else{if(t=="4"&&h=="1"){j.setNegativeFormat(j.PARENTHESIS);j.setCurrencyPosition(j.RIGHT_INSIDE)}else{if(t=="5"&&h=="1"){j.setNegativeFormat(j.LEFT_DASH);j.setCurrencyPosition(j.RIGHT_INSIDE)}else{if(t=="6"&&h=="1"){j.setNegativeFormat(j.RIGHT_DASH);j.setCurrencyPosition(j.RIGHT_OUTSIDE)}else{if(t=="7"&&h=="1"){j.setNegativeFormat(j.RIGHT_DASH);j.setCurrencyPosition(j.RIGHT_INSIDE)}else{if(t=="8"&&h=="3"){i=" "+i;j.setNegativeFormat(j.LEFT_DASH);j.setCurrencyPosition(j.RIGHT_INSIDE)}else{if(t=="9"&&h=="2"){i=i+" ";j.setNegativeFormat(j.LEFT_DASH);j.setCurrencyPosition(j.LEFT_INSIDE)}else{if(t=="10"&&h=="3"){i=" "+i;j.setNegativeFormat(j.RIGHT_DASH);j.setCurrencyPosition(j.RIGHT_INSIDE)}else{if(t=="11"&&h=="2"){i=i+" ";j.setNegativeFormat(j.RIGHT_DASH);j.setCurrencyPosition(j.LEFT_INSIDE)}else{if(t=="12"&&h=="2"){i=i+" ";j.setNegativeFormat(j.LEFT_DASH);j.setCurrencyPosition(j.LEFT_OUTSIDE)}else{if(t=="13"&&h=="3"){i=" "+i;j.setNegativeFormat(j.RIGHT_DASH);j.setCurrencyPosition(j.RIGHT_OUTSIDE)}else{if(t=="14"&&h=="2"){i=i+" ";j.setNegativeFormat(j.PARENTHESIS);j.setCurrencyPosition(j.LEFT_INSIDE)}else{if(t=="15"&&h=="3"){i=" "+i;j.setNegativeFormat(j.PARENTHESIS);j.setCurrencyPosition(j.RIGHT_INSIDE)}}}}}}}}}}}}}}}}j.setCurrencyValue(i);j.setCurrency(true);g=j.toFormatted();if(j.isValid){if(e!=null&&e.indexOf("int")>=0){q=j.getOriginalInteger()}else{q=j.getOriginal()}c.value=g;c.setAttribute("xml_value",q);return 1}else{c.setAttribute("xml_value",m);return -1}}else{if(d=="percentage"){var g="";var q="";var j=new NumberFormat154();if(InfoJet_NumberDecimalSeparator!="."&&InfoJet_NumberGroupSeparator!="."){m=m.replace(/\./g,InfoJet_NumberDecimalSeparator)}j.setInputDecimal(InfoJet_NumberDecimalSeparator);j.setNumber(m);j.setCurrencyValue("$");j.setCurrency(false);j.setCurrencyPosition(j.LEFT_OUTSIDE);j.setNegativeRed(false);if(o=="auto"){j.setPlaces("-1",false)}else{j.setPlaces(o,false)}if(v=="0"){j.setSeparators(false,",",",")}else{j.setSeparators(true,InfoJet_NumberGroupSeparator,InfoJet_NumberDecimalSeparator)}if(t=="0"){j.setNegativeFormat(j.PARENTHESIS)}else{if(t=="1"){j.setNegativeFormat(j.LEFT_DASH)}else{if(t=="2"){j.setNegativeFormat(j.LEFT_DASHSPACE)}else{if(t=="3"){j.setNegativeFormat(j.RIGHT_DASH)}else{if(t=="4"){j.setNegativeFormat(j.RIGHT_DASHSPACE)}}}}}g=j.toFormatted();if(j.isValid){q=j.getOriginalPercentage();c.value=g;c.setAttribute("xml_value",q);return 1}else{c.setAttribute("xml_value",m);return -1}}else{if(d=="boolean"){if(m=="1"||m=="0"){c.value=m}else{if(m=="true"){c.value="true"}else{c.value="false"}}return 1}else{if(d=="string"){return 1}else{if(d=="anyURI"){return 1}else{if(d=="any"){return 1}else{if(d=="date"){if(n.length<=0){return 0}if(n=="Long Date"){n=InfoJet_LongDatePattern}if(n=="Year Month"){n=InfoJet_YearMonthPattern}if(n=="Short Date"){n=InfoJet_ShortDatePattern}if(n.indexOf("dddd")>=0){return 0}if(n.indexOf("MMMM")>=0){return 0}if(n.indexOf("MMM")>=0){return 0}if(n.indexOf("'")>=0){return 0}if(n.indexOf("yyyy")<0&&n.indexOf("yy")>=0){return 0}var u=Date.parseString(m,n);if(u==null){u=InfoJet_ParseDate(m);if(u==null){if(m.length<=0){c.setAttribute("xml_value","");return 1}else{c.setAttribute("xml_value",m);return -1}}}c.value=u.format(n);c.setAttribute("xml_value",u.format("yyyy-MM-dd"));return 1}else{if(d=="time"){return 0}else{if(d=="datetime"){if(b=="none"){if(n.length<=0){return 0}if(n=="Long Date"){n=InfoJet_LongDatePattern}if(n=="Year Month"){n=InfoJet_YearMonthPattern}if(n=="Short Date"){n=InfoJet_ShortDatePattern}if(n.indexOf("dddd")>=0){return 0}if(n.indexOf("MMMM")>=0){return 0}if(n.indexOf("'")>=0){return 0}var u=Date.parseString(m,n);if(u==null){u=InfoJet_ParseDate(m);if(u==null){if(m.length<=0){c.setAttribute("xml_value","");return 1}else{c.setAttribute("xml_value",m);return -1}}}c.value=u.format(n);var s=u.format("yyyy-MM-dd");var a=s+"T00:00:00";var f=c.getAttribute(InfoJet_XdPrefix+"num");if(f){var r=f.indexOf("T");if(r>0){var l=f.substring(r);a=s+l}}c.setAttribute("xml_value",a);return 1}if(n=="none"){var f=c.getAttribute(InfoJet_XdPrefix+"num");if(f){var r=f.indexOf("T");if(r>0){var s=f.substring(0,r);c.setAttribute("xml_value",s+" "+m);return -1}}}return 0}else{if(d=="unknown"){return 0}}}}}}}}}}}return 0}function InfoJet_IsValidNumberChars(b){var a=new RegExp("[\\"+InfoJet_NumberGroupSeparator+"\\"+InfoJet_NumberDecimalSeparator+"\\d\\-\\+\\(\\)eE ]","g");b=b.replace(a,"");if(b.length<=0){return true}else{return false}}function NumberFormat154(a,b){this.VERSION="Number Format v1.5.4";this.COMMA=",";this.PERIOD=".";this.DASH="-";this.LEFT_PAREN="(";this.RIGHT_PAREN=")";this.LEFT_OUTSIDE=0;this.LEFT_INSIDE=1;this.RIGHT_INSIDE=2;this.RIGHT_OUTSIDE=3;this.LEFT_DASH=0;this.RIGHT_DASH=1;this.PARENTHESIS=2;this.LEFT_DASHSPACE=3;this.RIGHT_DASHSPACE=4;this.NO_ROUNDING=-1;this.num;this.hasSeparators=false;this.separatorValue;this.inputDecimalValue;this.decimalValue;this.negativeFormat;this.negativeRed;this.hasCurrency;this.currencyPosition;this.currencyValue;this.places;this.roundToPlaces;this.truncate;this.isValid;this.setNumber=setNumberNF;this.toUnformatted=toUnformattedNF;this.setInputDecimal=setInputDecimalNF;this.setSeparators=setSeparatorsNF;this.setCommas=setCommasNF;this.setNegativeFormat=setNegativeFormatNF;this.setNegativeRed=setNegativeRedNF;this.setCurrency=setCurrencyNF;this.setCurrencyPrefix=setCurrencyPrefixNF;this.setCurrencyValue=setCurrencyValueNF;this.setCurrencyPosition=setCurrencyPositionNF;this.setPlaces=setPlacesNF;this.toFormatted=toFormattedNF;this.toPercentage=toPercentageNF;this.getOriginal=getOriginalNF;this.getOriginalPercentage=getOriginalPercentageNF;this.getOriginalInteger=getOriginalIntegerNF;this.moveDecimalRight=moveDecimalRightNF;this.moveDecimalLeft=moveDecimalLeftNF;this.getRounded=getRoundedNF;this.preserveZeros=preserveZerosNF;this.justNumber=justNumberNF;this.expandExponential=expandExponentialNF;this.getZeros=getZerosNF;this.moveDecimalAsString=moveDecimalAsStringNF;this.moveDecimal=moveDecimalNF;this.addSeparators=addSeparatorsNF;if(b==null){this.setNumber(a,this.PERIOD)}else{this.setNumber(a,b)}this.setCommas(true);this.setNegativeFormat(this.LEFT_DASH);this.setNegativeRed(false);this.setCurrency(false);this.setCurrencyPrefix("$");this.setPlaces(2)}function setInputDecimalNF(a){this.inputDecimalValue=a}function setNumberNF(a,b){if(b!=null){this.setInputDecimal(b)}this.num=this.justNumber(a)}function toUnformattedNF(){return(this.num)}function getOriginalNF(){return(this.num)}function getOriginalPercentageNF(){return(parseFloat(this.moveDecimalLeft(this.num+"",2)))}function getOriginalIntegerNF(){return(parseInt(this.num))}function setNegativeFormatNF(a){this.negativeFormat=a}function setNegativeRedNF(a){this.negativeRed=a}function setSeparatorsNF(b,c,a){this.hasSeparators=b;if(c==null){c=this.COMMA}if(a==null){a=this.PERIOD}if(c==a){this.decimalValue=(a==this.PERIOD)?this.COMMA:this.PERIOD}else{this.decimalValue=a}this.separatorValue=c}function setCommasNF(a){this.setSeparators(a,this.COMMA,this.PERIOD)}function setCurrencyNF(a){this.hasCurrency=a}function setCurrencyValueNF(a){this.currencyValue=a}function setCurrencyPrefixNF(a){this.setCurrencyValue(a);this.setCurrencyPosition(this.LEFT_OUTSIDE)}function setCurrencyPositionNF(a){this.currencyPosition=a}function setPlacesNF(b,a){this.roundToPlaces=!(b==this.NO_ROUNDING);this.truncate=(a!=null&&a);this.places=(b<0)?0:b}function addSeparatorsNF(d,e,a,c){d+="";var f=d.indexOf(e);var g="";if(f!=-1){g=a+d.substring(f+1,d.length);d=d.substring(0,f)}if(!InfoJet_EnableReplaceGroupingSymbol){var b=/(\d+)(\d{3})/;while(b.test(d)){d=d.replace(b,"$1"+c+"$2")}}return d+g}function toFormattedNF(){var l;var m=this.num;var a;var b=new Array(2);if(this.roundToPlaces){m=this.getRounded(m);a=this.preserveZeros(Math.abs(m))}else{a=this.expandExponential(Math.abs(m))}if(this.hasSeparators){a=this.addSeparators(a,this.PERIOD,this.decimalValue,this.separatorValue)}else{a=a.replace(new RegExp("\\"+this.PERIOD),this.decimalValue)}var f="";var k="";var e="";var j="";var h="";var d="";var g="";var c="";var n=(this.negativeFormat==this.PARENTHESIS)?this.LEFT_PAREN:this.DASH;var i=(this.negativeFormat==this.PARENTHESIS)?this.RIGHT_PAREN:this.DASH;if(this.currencyPosition==this.LEFT_OUTSIDE){if(m<0){if(this.negativeFormat==this.LEFT_DASH||this.negativeFormat==this.PARENTHESIS){j=n}if(this.negativeFormat==this.RIGHT_DASH||this.negativeFormat==this.PARENTHESIS){h=i}if(this.negativeFormat==this.LEFT_DASHSPACE){j="- "}if(this.negativeFormat==this.RIGHT_DASHSPACE){h=" -"}}if(this.hasCurrency){f=this.currencyValue}}else{if(this.currencyPosition==this.LEFT_INSIDE){if(m<0){if(this.negativeFormat==this.LEFT_DASH||this.negativeFormat==this.PARENTHESIS){k=n}if(this.negativeFormat==this.RIGHT_DASH||this.negativeFormat==this.PARENTHESIS){g=i}}if(this.hasCurrency){e=this.currencyValue}}else{if(this.currencyPosition==this.RIGHT_INSIDE){if(m<0){if(this.negativeFormat==this.LEFT_DASH||this.negativeFormat==this.PARENTHESIS){k=n}if(this.negativeFormat==this.RIGHT_DASH||this.negativeFormat==this.PARENTHESIS){g=i}}if(this.hasCurrency){d=this.currencyValue}}else{if(this.currencyPosition==this.RIGHT_OUTSIDE){if(m<0){if(this.negativeFormat==this.LEFT_DASH||this.negativeFormat==this.PARENTHESIS){j=n}if(this.negativeFormat==this.RIGHT_DASH||this.negativeFormat==this.PARENTHESIS){h=i}}if(this.hasCurrency){c=this.currencyValue}}}}}a=f+k+e+j+a+h+d+g+c;if(this.negativeRed&&m<0){a='<font color="red">'+a+"</font>"}return(a)}function toPercentageNF(){nNum=this.num*100;nNum=this.getRounded(nNum);return nNum+"%"}function getZerosNF(a){var c="";var b;for(b=0;b<a;b++){c+="0"}return c}function expandExponentialNF(b){if(isNaN(b)){return b}var d=parseFloat(b)+"";var g=d.toLowerCase().indexOf("e");if(g!=-1){var a=d.toLowerCase().indexOf("+");var e=d.toLowerCase().indexOf("-",g);var f=d.substring(0,g);if(e!=-1){var c=d.substring(e+1,d.length);f=this.moveDecimalAsString(f,true,parseInt(c))}else{if(a==-1){a=g}var c=d.substring(a+1,d.length);f=this.moveDecimalAsString(f,false,parseInt(c))}d=f}return d}function moveDecimalRightNF(c,b){var a="";if(b==null){a=this.moveDecimal(c,false)}else{a=this.moveDecimal(c,false,b)}return a}function moveDecimalLeftNF(c,b){var a="";if(b==null){a=this.moveDecimal(c,true)}else{a=this.moveDecimal(c,true,b)}return a}function moveDecimalAsStringNF(d,e,a){var i=(arguments.length<3)?this.places:a;if(i<=0){return d}var b=d+"";var f=this.getZeros(i);var h=new RegExp("([0-9.]+)");if(e){b=b.replace(h,f+"$1");var g=new RegExp("(-?)([0-9]*)([0-9]{"+i+"})(\\.?)");b=b.replace(g,"$1$2.$3")}else{var c=h.exec(b);if(c!=null){b=b.substring(0,c.index)+c[1]+f+b.substring(c.index+c[0].length)}var g=new RegExp("(-?)([0-9]*)(\\.?)([0-9]{"+i+"})");b=b.replace(g,"$1$2$4.")}b=b.replace(/\.$/,"");return b}function moveDecimalNF(d,c,b){var a="";if(b==null){a=this.moveDecimalAsString(d,c)}else{a=this.moveDecimalAsString(d,c,b)}return parseFloat(a)}function getRoundedNF(a){a=this.moveDecimalRight(a);if(this.truncate){a=a>=0?Math.floor(a):Math.ceil(a)}else{a=Math.round(a)}a=this.moveDecimalLeft(a);return a}function preserveZerosNF(c){var b;c=this.expandExponential(c);if(this.places<=0){return c}var a=c.indexOf(".");if(a==-1){c+=".";for(b=0;b<this.places;b++){c+="0"}}else{var e=(c.length-1)-a;var d=this.places-e;for(b=0;b<d;b++){c+="0"}}return c}function justNumberNF(e){newVal=e+"";var d=false;if(newVal.indexOf("%")!=-1){newVal=newVal.replace(/\%/g,"");d=true}var b=new RegExp("[^\\"+this.inputDecimalValue+"\\d\\-\\+\\(\\)eE]","g");newVal=newVal.replace(b,"");var f=new RegExp("["+this.inputDecimalValue+"]","g");var c=f.exec(newVal);if(c!=null){var a=newVal.substring(c.index+c[0].length);newVal=newVal.substring(0,c.index)+this.PERIOD+a.replace(f,"")}if(newVal.charAt(newVal.length-1)==this.DASH){newVal=newVal.substring(0,newVal.length-1);newVal="-"+newVal}else{if(newVal.charAt(0)==this.LEFT_PAREN&&newVal.charAt(newVal.length-1)==this.RIGHT_PAREN){newVal=newVal.substring(1,newVal.length-1);newVal="-"+newVal}}newVal=parseFloat(newVal);if(!isFinite(newVal)){newVal=0;this.isValid=false}else{this.isValid=true}if(d){newVal=this.moveDecimalLeft(newVal,2)}return newVal}Date.$VERSION=1.02;Date.LZ=function(a){return(a<0||a>9?"":"0")+a};Date.monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December");Date.monthAbbreviations=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");Date.dayNames=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");Date.dayAbbreviations=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat");Date.preferAmericanFormat=true;if(!Date.prototype.getFullYear){Date.prototype.getFullYear=function(){var a=this.getYear();return(a<1900?a+1900:a)}}Date.parseString=function(H,A){if(typeof(A)=="undefined"||A==null||A==""){var o=new Array("y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d","MMM-d","d-MMM");var b=new Array("M/d/y","M-d-y","M.d.y","M/d","M-d");var n=new Array("d/M/y","d-M-y","d.M.y","d/M","d-M");var e=new Array(o,Date.preferAmericanFormat?b:n,Date.preferAmericanFormat?n:b);for(var w=0;w<e.length;w++){var u=e[w];for(var v=0;v<u.length;v++){var B=Date.parseString(H,u[v]);if(B!=null){return B}}}return null}this.isInteger=function(d){for(var c=0;c<d.length;c++){if("1234567890".indexOf(d.charAt(c))==-1){return false}}return true};this.getInt=function(I,l,y,j){for(var c=j;c>=y;c--){var d=I.substring(l,l+c);if(d.length<y){return null}if(this.isInteger(d)){return d}}return null};H=H+"";A=A+"";var G=0;var r=0;var D="";var g="";var F="";var k,h;var m=new Date().getFullYear();var E=1;var C=1;var a=0;var z=0;var t=0;var q="";while(r<A.length){D=A.charAt(r);g="";while((A.charAt(r)==D)&&(r<A.length)){g+=A.charAt(r++)}if(g=="yyyy"||g=="yy"||g=="y"){if(g=="yyyy"){k=4;h=4}if(g=="yy"){k=2;h=2}if(g=="y"){k=2;h=4}m=this.getInt(H,G,k,h);if(m==null){return null}G+=m.length;if(m.length==2){if(m>70){m=1900+(m-0)}else{m=2000+(m-0)}}}else{if(g=="MMM"||g=="NNN"){E=0;var p=(g=="MMM"?(Date.monthNames.concat(Date.monthAbbreviations)):Date.monthAbbreviations);for(var w=0;w<p.length;w++){var f=p[w];if(H.substring(G,G+f.length).toLowerCase()==f.toLowerCase()){E=(w%12)+1;G+=f.length;break}}if((E<1)||(E>12)){return null}}else{if(g=="EE"||g=="E"){var p=(g=="EE"?Date.dayNames:Date.dayAbbreviations);for(var w=0;w<p.length;w++){var s=p[w];if(H.substring(G,G+s.length).toLowerCase()==s.toLowerCase()){G+=s.length;break}}}else{if(g=="MM"||g=="M"){E=this.getInt(H,G,g.length,2);if(E==null||(E<1)||(E>12)){return null}G+=E.length}else{if(g=="dd"||g=="d"){C=this.getInt(H,G,g.length,2);if(C==null||(C<1)||(C>31)){return null}G+=C.length}else{if(g=="hh"||g=="h"){a=this.getInt(H,G,g.length,2);if(a==null||(a<1)||(a>12)){return null}G+=a.length}else{if(g=="HH"||g=="H"){a=this.getInt(H,G,g.length,2);if(a==null||(a<0)||(a>23)){return null}G+=a.length}else{if(g=="KK"||g=="K"){a=this.getInt(H,G,g.length,2);if(a==null||(a<0)||(a>11)){return null}G+=a.length;a++}else{if(g=="kk"||g=="k"){a=this.getInt(H,G,g.length,2);if(a==null||(a<1)||(a>24)){return null}G+=a.length;a--}else{if(g=="mm"||g=="m"){z=this.getInt(H,G,g.length,2);if(z==null||(z<0)||(z>59)){return null}G+=z.length}else{if(g=="ss"||g=="s"){t=this.getInt(H,G,g.length,2);if(t==null||(t<0)||(t>59)){return null}G+=t.length}else{if(g=="a"){if(H.substring(G,G+2).toLowerCase()=="am"){q="AM"}else{if(H.substring(G,G+2).toLowerCase()=="pm"){q="PM"}else{return null}}G+=2}else{if(H.substring(G,G+g.length)!=g){return null}else{G+=g.length}}}}}}}}}}}}}}if(G!=H.length){return null}if(E==2){if(((m%4==0)&&(m%100!=0))||(m%400==0)){if(C>29){return null}}else{if(C>28){return null}}}if((E==4)||(E==6)||(E==9)||(E==11)){if(C>30){return null}}if(a<12&&q=="PM"){a=a-0+12}else{if(a>11&&q=="AM"){a-=12}}return new Date(m,E-1,C,a,z,t)};Date.isValid=function(b,a){return(Date.parseString(b,a)!=null)};Date.prototype.isBefore=function(a){if(a==null){return false}return(this.getTime()<a.getTime())};Date.prototype.isAfter=function(a){if(a==null){return false}return(this.getTime()>a.getTime())};Date.prototype.equals=function(a){if(a==null){return false}return(this.getTime()==a.getTime())};Date.prototype.equalsIgnoreTime=function(c){if(c==null){return false}var b=new Date(this.getTime()).clearTime();var a=new Date(c.getTime()).clearTime();return(b.getTime()==a.getTime())};Date.prototype.format=function(D){D=D+"";var l="";var v=0;var G="";var f="";var j=this.getYear()+"";var g=this.getMonth()+1;var F=this.getDate();var o=this.getDay();var n=this.getHours();var x=this.getMinutes();var q=this.getSeconds();var t,u,b,r,I,e,C,B,z,p,L,n,J,i,a,A;var w=new Object();if(j.length<4){j=""+(+j+1900)}w.y=""+j;w.yyyy=j;w.yy=j.substring(2,4);w.M=g;w.MM=Date.LZ(g);w.MMM=Date.monthNames[g-1];w.NNN=Date.monthAbbreviations[g-1];w.d=F;w.dd=Date.LZ(F);w.E=Date.dayAbbreviations[o];w.EE=Date.dayNames[o];w.H=n;w.HH=Date.LZ(n);if(n==0){w.h=12}else{if(n>12){w.h=n-12}else{w.h=n}}w.hh=Date.LZ(w.h);w.K=w.h-1;w.k=w.H+1;w.KK=Date.LZ(w.K);w.kk=Date.LZ(w.k);if(n>11){w.a="PM"}else{w.a="AM"}w.m=x;w.mm=Date.LZ(x);w.s=q;w.ss=Date.LZ(q);while(v<D.length){G=D.charAt(v);f="";while((D.charAt(v)==G)&&(v<D.length)){f+=D.charAt(v++)}if(typeof(w[f])!="undefined"){l=l+w[f]}else{l=l+f}}return l};Date.prototype.getDayName=function(){return Date.dayNames[this.getDay()]};Date.prototype.getDayAbbreviation=function(){return Date.dayAbbreviations[this.getDay()]};Date.prototype.getMonthName=function(){return Date.monthNames[this.getMonth()]};Date.prototype.getMonthAbbreviation=function(){return Date.monthAbbreviations[this.getMonth()]};Date.prototype.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};Date.prototype.add=function(a,c){if(typeof(a)=="undefined"||a==null||typeof(c)=="undefined"||c==null){return this}c=+c;if(a=="y"){this.setFullYear(this.getFullYear()+c)}else{if(a=="M"){this.setMonth(this.getMonth()+c)}else{if(a=="d"){this.setDate(this.getDate()+c)}else{if(a=="w"){var b=(c>0)?1:-1;while(c!=0){this.add("d",b);while(this.getDay()==0||this.getDay()==6){this.add("d",b)}c-=b}}else{if(a=="h"){this.setHours(this.getHours()+c)}else{if(a=="m"){this.setMinutes(this.getMinutes()+c)}else{if(a=="s"){this.setSeconds(this.getSeconds()+c)}}}}}}}return this};function InfoJet_IsFireFox(){if(navigator.userAgent.indexOf("Firefox")>0){return true}else{return false}}function InfoJet_InsertAdjacentHTMLBeforeEnd(d,b){if(InfoJet_IsIE()){d.insertAdjacentHTML("BeforeEnd",b)}else{if(InfoJet_IsFireFox()){var a=document.createRange();var c=a.createContextualFragment(b);d.appendChild(c)}else{var a=d.ownerDocument.createRange();a.selectNodeContents(d);a.collapse(d);var e=a.createContextualFragment(b);d.appendChild(e)}}}function InfoJet_ReplaceNodeWithHTML(d,b){if(InfoJet_IsIE()){d.outerHTML=b}else{var a=document.createRange();var c=a.createContextualFragment(b);d.parentNode.replaceChild(c,d)}}function InfoJet_RemoveHtmlElement(a){if(InfoJet_IsIE()){a.outerHTML=""}else{a.parentNode.removeChild(a)}}function InfoJet_GetPreviousElement(b){var a=b.previousSibling;while(a!=null){if(a.tagName&&a.tagName.indexOf("/")<0){return a}else{a=a.previousSibling}}return null}function InfoJet_GetNextElement(b){var a=b.nextSibling;while(a!=null){if(a.tagName&&a.tagName.indexOf("/")<0){return a}else{a=a.nextSibling}}return null}function InfoJet_GetElements(c){var d=new Array();for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];if(a.nodeType==1&&a.tagName&&a.tagName.indexOf("/")<0){d.push(a)}}return d}function InfoJet_GetFirstChild(b){for(var a=0;a<b.childNodes.length;a++){var c=b.childNodes[a];if(c.tagName&&c.tagName.indexOf("/")<0){return c}}}function InfoJet_GetLastChild(c){var b=null;for(var a=0;a<c.childNodes.length;a++){var d=c.childNodes[a];if(d.tagName&&d.tagName.indexOf("/")<0){b=d}}return b}function InfoJet_CancelEvent(a){if(InfoJet_IsIE()){a.cancelBubble=true}else{a.stopPropagation()}}function InfoJet_GetHtmlSelectValue(c){if(InfoJet_IsIE()){return c.value}else{try{var a=c.options[c.selectedIndex];if(a.getAttribute("value")!=null){return c.value}else{return""}}catch(b){return c.value}}}function InfoJet_RemoveFocus(){if(InfoJet_IsIE()){document.body.focus()}else{if(InfoJet_FocusHolder!=null){InfoJet_FocusHolder.focus()}}}function InfoJet_EndsWith(b,a){if(b.length<a.length){return false}if(b.indexOf(a)==(b.length-a.length)){return true}else{return false}}function InfoJet_Trim(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function InfoJet_GetText(a){if(InfoJet_IsIE()){return a.innerHTML}else{if(a.textContent){return a.textContent}else{return""}}}function InfoJet_UpdateSingleFieldByName(c,g){var e=document.getElementById("xdoc_form");for(var d=0;d<e.childNodes.length;d++){var f=e.childNodes[d];if(f.nodeType==1){if(f.name){if(InfoJet_EndsWith(f.name,c)){f.value=g;var a=f.name.substring(4);var h=document.getElementById(a);if(h!=null){h.value=g}for(var b=1;true;b++){h=document.getElementById(a+","+b);if(h!=null){h.value=g}else{break}}break}}}}}function InfoJet_GetSingleFieldValueByName(a){var c=document.getElementById("xdoc_form");for(var b=0;b<c.childNodes.length;b++){var d=c.childNodes[b];if(d.nodeType==1){if(d.name){if(InfoJet_EndsWith(d.name,a)){return d.value}}}}return null}function InfoJet_StopEvent(a){if(!a){if(window.event){a=window.event}}else{return}if(a.cancelBubble!=null){a.cancelBubble=true}if(a.stopPropagation){a.stopPropagation()}if(a.preventDefault){a.preventDefault()}if(window.event){a.returnValue=false}if(a.cancel!=null){a.cancel=true}};