Calendar.setup=function(g){function f(h,i){if(typeof g[h]=="undefined"){g[h]=i}}f("inputField",null);f("displayArea",null);f("button",null);f("eventName","click");f("ifFormat","%Y/%m/%d");f("daFormat","%Y/%m/%d");f("singleClick",true);f("disableFunc",null);f("dateStatusFunc",g.disableFunc);f("dateText",null);f("firstDay",1);f("align","Br");f("range",[1900,2999]);f("weekNumbers",true);f("flat",null);f("flatCallback",null);f("onSelect",null);f("onClose",null);f("onUpdate",null);f("date",null);f("showsTime",false);f("timeFormat","24");f("electric",true);f("step",2);f("position",null);f("cache",true);f("showOthers",false);f("multiple",null);var c=["inputField","displayArea","button"];for(var b in c){if(typeof g[c[b]]=="string"){g[c[b]]=document.getElementById(g[c[b]])}}if(typeof g.xdocInputField!="undefined"){g.inputField=g.xdocInputField}if(typeof g.xdocButton!="undefined"){g.button=g.xdocButton}if(!(g.flat||g.multiple||g.inputField||g.displayArea||g.button)){alert("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}function a(k){var j=k.params;var l=(k.dateClicked||j.electric);if(l&&j.inputField){InfoJet_RecordOldValueState(j.inputField);var i=k.date.print("%Y-%m-%d");j.inputField.setAttribute("date_num",i);var h=k.date.print(j.ifFormat);j.inputField.value=h;if(typeof j.inputField.onchange=="function"){j.inputField.onchange()}}if(l&&j.displayArea){j.displayArea.innerHTML=k.date.print(j.daFormat)}if(l&&typeof j.onUpdate=="function"){j.onUpdate(k)}if(l&&j.flat){if(typeof j.flatCallback=="function"){j.flatCallback(k)}}if(l&&j.singleClick&&k.dateClicked){k.callCloseHandler()}}if(g.flat!=null){if(typeof g.flat=="string"){g.flat=document.getElementById(g.flat)}if(!g.flat){alert("Calendar.setup:\n  Flat specified but can't find parent.");return false}var e=new Calendar(g.firstDay,g.date,g.onSelect||a);e.showsOtherMonths=g.showOthers;e.showsTime=g.showsTime;e.time24=(g.timeFormat=="24");e.params=g;e.weekNumbers=g.weekNumbers;e.setRange(g.range[0],g.range[1]);e.setDateStatusHandler(g.dateStatusFunc);e.getDateText=g.dateText;if(g.ifFormat){e.setDateFormat(g.ifFormat)}if(g.inputField&&typeof g.inputField.value=="string"){e.parseDate(g.inputField.value)}e.create(g.flat);e.show();return false}var d=g.button||g.displayArea||g.inputField;d.clickPickerButton=function(){var p=g.inputField.getAttribute("readonly");if(p){return false}var n=g.inputField||g.displayArea;var r=g.inputField?g.ifFormat:g.daFormat;var l=false;var j=window.calendar;if(n){g.date=Date.parseDate(n.value||n.innerHTML,r)}var h=g.inputField.getAttribute("date_num");if(h&&h.length>0){var m=Date.parseDate(h,"%Y-%m-%d");g.date=m}if(!(j&&g.cache)){window.calendar=j=new Calendar(g.firstDay,g.date,g.onSelect||a,g.onClose||function(i){i.hide()});j.showsTime=g.showsTime;j.time24=(g.timeFormat=="24");j.weekNumbers=g.weekNumbers;l=true}else{if(g.date){j.setDate(g.date)}j.hide()}if(g.multiple){j.multiple={};for(var o=g.multiple.length;--o>=0;){var q=g.multiple[o];var k=q.print("%Y%m%d");j.multiple[k]=q}}j.showsOtherMonths=g.showOthers;j.yearStep=g.step;j.setRange(g.range[0],g.range[1]);j.params=g;j.setDateStatusHandler(g.dateStatusFunc);j.getDateText=g.dateText;j.setDateFormat(r);if(l){j.create()}j.refresh();if(!g.position){j.showAtElement(g.button||g.displayArea||g.inputField,g.align)}else{j.showAt(g.position[0],g.position[1])}return false};return e};